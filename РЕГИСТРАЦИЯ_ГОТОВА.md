# ‚úÖ –°–ò–°–¢–ï–ú–ê –†–ï–ì–ò–°–¢–†–ê–¶–ò–ò –ì–û–¢–û–í–ê

**–î–∞—Ç–∞:** 2025-11-04  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

---

## üéØ –ß–¢–û –°–î–ï–õ–ê–ù–û

### 1. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö - –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ä–æ–ª–∏ ‚úÖ

**–§–∞–π–ª:** `/lib/database/user_roles_migration.sql`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ `roles JSONB` (–º–∞—Å—Å–∏–≤ —Ä–æ–ª–µ–π)
- ‚úÖ –ú–∏–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Å—Ç–∞—Ä–æ–≥–æ –ø–æ–ª—è `role`
- ‚úÖ –§—É–Ω–∫—Ü–∏—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ `validate_user_roles()`
- ‚úÖ –§—É–Ω–∫—Ü–∏—è –ø—Ä–æ–≤–µ—Ä–∫–∏ `user_has_role()`
- ‚úÖ GIN –∏–Ω–¥–µ–∫—Å –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞
- ‚úÖ View `users_with_primary_role` –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏

**–î–æ–ø—É—Å—Ç–∏–º—ã–µ —Ä–æ–ª–∏:**
```typescript
'tourist'           // –¢—É—Ä–∏—Å—Ç
'operator'          // –¢—É—Ä–æ–ø–µ—Ä–∞—Ç–æ—Ä
'guide'             // –ì–∏–¥
'provider'          // –ü–æ—Å—Ç–∞–≤—â–∏–∫
'driver'            // –í–æ–¥–∏—Ç–µ–ª—å
'hotel_manager'     // –ú–µ–Ω–µ–¥–∂–µ—Ä –æ—Ç–µ–ª—è
'restaurant_owner'  // –í–ª–∞–¥–µ–ª–µ—Ü —Ä–µ—Å—Ç–æ—Ä–∞–Ω–∞
```

**–ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤:**
```sql
-- –ù–∞–π—Ç–∏ –≤—Å–µ—Ö —Ç—É—Ä–∏—Å—Ç–æ–≤
SELECT * FROM users WHERE roles @> '["tourist"]';

-- –ù–∞–π—Ç–∏ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤
SELECT * FROM users WHERE roles @> '["operator"]';

-- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ —Ä–æ–ª—è–º–∏
SELECT * FROM users WHERE jsonb_array_length(roles) > 1;

-- –î–æ–±–∞–≤–∏—Ç—å —Ä–æ–ª—å
UPDATE users 
SET roles = roles || '["guide"]'::jsonb
WHERE id = 'uuid' AND NOT roles @> '["guide"]';
```

---

### 2. –§–æ—Ä–º–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ —Ç—É—Ä–∏—Å—Ç–∞ ‚úÖ

**–§–∞–π–ª:** `/app/auth/register-tourist/page.tsx`

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**
- ‚úÖ –ü—Ä–æ—Å—Ç–∞—è —Ñ–æ—Ä–º–∞ (–ò–º—è, Email, –ü–∞—Ä–æ–ª—å)
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–∞—Ä–æ–ª–µ–π
- ‚úÖ Lucide-react –∏–∫–æ–Ω–∫–∏
- ‚úÖ Premium –¥–∏–∑–∞–π–Ω
- ‚úÖ –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π layout
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏—Å–≤–æ–µ–Ω–∏–µ —Ä–æ–ª–∏ `['tourist']`
- ‚úÖ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞ —Å –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞–º–∏

**–ü–æ–ª—è:**
```
- –ò–º—è –∏ —Ñ–∞–º–∏–ª–∏—è *
- Email *
- –ü–∞—Ä–æ–ª—å * (–º–∏–Ω–∏–º—É–º 6 —Å–∏–º–≤–æ–ª–æ–≤)
- –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–∞—Ä–æ–ª—è *
```

**–ü–æ—Å–ª–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏:**
- –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ `/hub/tourist`

---

### 3. –§–æ—Ä–º–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –±–∏–∑–Ω–µ—Å–∞ ‚úÖ

**–§–∞–π–ª:** `/app/auth/register-business/page.tsx`

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**
- ‚úÖ **2-—ç—Ç–∞–ø–Ω–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è:**
  - –®–∞–≥ 1: –í—ã–±–æ—Ä —Ä–æ–ª–µ–π (–æ–¥–Ω–∞ –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ)
  - –®–∞–≥ 2: –ö–æ–Ω—Ç–∞–∫—Ç–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
- ‚úÖ 6 –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Ä–æ–ª–µ–π —Å –∫—Ä–∞—Å–∏–≤—ã–º–∏ –∫–∞—Ä—Ç–æ—á–∫–∞–º–∏
- ‚úÖ –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –≤—ã–±–æ—Ä —Ä–æ–ª–µ–π
- ‚úÖ Progress indicator (–∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø—Ä–æ–≥—Ä–µ—Å—Å–∞)
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö –ø–æ–ª–µ–π
- ‚úÖ –£–º–Ω–æ–µ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π –¥–∞—à–±–æ—Ä–¥

**–î–æ—Å—Ç—É–ø–Ω—ã–µ —Ä–æ–ª–∏:**

| –†–æ–ª—å | –ò–∫–æ–Ω–∫–∞ | –¶–≤–µ—Ç | –î–∞—à–±–æ—Ä–¥ |
|------|--------|------|---------|
| **–¢—É—Ä–æ–ø–µ—Ä–∞—Ç–æ—Ä** | Briefcase | –°–∏–Ω–∏–π | `/hub/tour-operator` |
| **–ì–∏–¥** | User | –ó–µ–ª–µ–Ω—ã–π | `/hub/guide` |
| **–í–æ–¥–∏—Ç–µ–ª—å** | Car | –§–∏–æ–ª–µ—Ç–æ–≤—ã–π | `/hub/transfer-operator` |
| **–ü–æ—Å—Ç–∞–≤—â–∏–∫** | Backpack | –û—Ä–∞–Ω–∂–µ–≤—ã–π | `/hub/operator` |
| **–†–∞–∑–º–µ—â–µ–Ω–∏–µ** | Hotel | –†–æ–∑–æ–≤—ã–π | `/hub/operator` |
| **–†–µ—Å—Ç–æ—Ä–∞–Ω** | Utensils | –ö—Ä–∞—Å–Ω—ã–π | `/hub/operator` |

**–ü–æ–ª—è (–®–∞–≥ 2):**
```
- –í–∞—à–µ –∏–º—è *
- –ù–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏ *
- Email *
- –¢–µ–ª–µ—Ñ–æ–Ω
- –ü–∞—Ä–æ–ª—å *
- –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–∞—Ä–æ–ª—è *
```

**–ü–æ—Å–ª–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏:**
- –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ –¥–∞—à–±–æ—Ä–¥ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç primary role (–ø–µ—Ä–≤–æ–π –≤—ã–±—Ä–∞–Ω–Ω–æ–π —Ä–æ–ª–∏)

---

### 4. –°—Ç—Ä–∞–Ω–∏—Ü–∞ –≤—ã–±–æ—Ä–∞ —Ç–∏–ø–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ ‚úÖ

**–§–∞–π–ª:** `/app/auth/register/page.tsx`

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**
- ‚úÖ –î–≤–µ –∫—Ä–∞—Å–∏–≤—ã–µ –∫–∞—Ä—Ç–æ—á–∫–∏:
  - "–Ø —Ç—É—Ä–∏—Å—Ç" ‚Üí `/auth/register-tourist`
  - "–î–ª—è –±–∏–∑–Ω–µ—Å–∞" ‚Üí `/auth/register-business`
- ‚úÖ Hover —ç—Ñ—Ñ–µ–∫—Ç—ã
- ‚úÖ –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤
- ‚úÖ –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –¥–∏–∑–∞–π–Ω

---

### 5. –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π API —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ ‚úÖ

**–§–∞–π–ª:** `/app/api/auth/signup/route.ts`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º–∞—Å—Å–∏–≤–∞ `roles`
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è —Ä–æ–ª–µ–π
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π:
  - `companyName` (–¥–ª—è –±–∏–∑–Ω–µ—Å–∞)
  - `phone` (–¥–ª—è –±–∏–∑–Ω–µ—Å–∞)
- ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ `primaryRole` (–ø–µ—Ä–≤–∞—è —Ä–æ–ª—å –∏–∑ –º–∞—Å—Å–∏–≤–∞)
- ‚úÖ –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö

**Request body:**
```json
{
  "name": "–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤",
  "email": "ivan@example.com",
  "password": "password123",
  "roles": ["operator", "guide"],
  "companyName": "–û–û–û '–ö–∞–º—á–∞—Ç–∫–∞ –¢—É—Ä'",  // optional
  "phone": "+7 999 123 45 67"           // optional
}
```

**Response (success):**
```json
{
  "success": true,
  "user": {
    "id": "user_1730000000000",
    "email": "ivan@example.com",
    "name": "–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤",
    "companyName": "–û–û–û '–ö–∞–º—á–∞—Ç–∫–∞ –¢—É—Ä'",
    "phone": "+7 999 123 45 67",
    "roles": ["operator", "guide"],
    "primaryRole": "operator",
    "preferences": { ... },
    "createdAt": "2025-11-04T...",
    "updatedAt": "2025-11-04T..."
  },
  "message": "–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞"
}
```

---

## üé® –î–ò–ó–ê–ô–ù –ò UX

### –û–±—â–∏–µ —Ñ–∏—á–∏:
- ‚úÖ **Premium –¥–∏–∑–∞–π–Ω** - —á–µ—Ä–Ω—ã–π + –∑–æ–ª–æ—Ç–æ
- ‚úÖ **Lucide-react –∏–∫–æ–Ω–∫–∏** - –≤–º–µ—Å—Ç–æ —ç–º–æ–¥–∑–∏
- ‚úÖ **–ü–ª–∞–≤–Ω—ã–µ –∞–Ω–∏–º–∞—Ü–∏–∏** - transitions, transforms
- ‚úÖ **–ì—Ä–∞–¥–∏–µ–Ω—Ç—ã** - –∫—Ä–∞—Å–∏–≤—ã–µ –∫–Ω–æ–ø–∫–∏
- ‚úÖ **–ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å** - —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –≤—Å–µ—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö
- ‚úÖ **–í–∞–ª–∏–¥–∞—Ü–∏—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏**
- ‚úÖ **Loading —Å–æ—Å—Ç–æ—è–Ω–∏—è** - —Å–ø–∏–Ω–Ω–µ—Ä –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ
- ‚úÖ **–°–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö** - –ø–æ–Ω—è—Ç–Ω—ã–µ –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–µ

### –§–æ—Ä–º–∞ —Ç—É—Ä–∏—Å—Ç–∞:
- –ü—Ä–æ—Å—Ç–∞—è –∏ –±—ã—Å—Ç—Ä–∞—è
- –ú–∏–Ω–∏–º—É–º –ø–æ–ª–µ–π
- –§–æ–∫—É—Å –Ω–∞ —Å–∫–æ—Ä–æ—Å—Ç—å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏

### –§–æ—Ä–º–∞ –±–∏–∑–Ω–µ—Å–∞:
- 2-—ç—Ç–∞–ø–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å
- –í–∏–∑—É–∞–ª—å–Ω—ã–π –≤—ã–±–æ—Ä —Ä–æ–ª–µ–π
- –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –≤—ã–±–æ—Ä
- Progress indicator
- –ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

---

## üîÑ –ú–ê–†–®–†–£–¢–´

### –ù–æ–≤—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã:

```
/auth/register               ‚Üí –í—ã–±–æ—Ä —Ç–∏–ø–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
/auth/register-tourist       ‚Üí –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Ç—É—Ä–∏—Å—Ç–∞
/auth/register-business      ‚Üí –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –±–∏–∑–Ω–µ—Å–∞
```

### –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π):

```
/auth/login                  ‚Üí –í—Ö–æ–¥
/auth/demo                   ‚Üí –î–µ–º–æ —Ä–µ–∂–∏–º
```

---

## üìä –ü–†–ò–ú–ï–†–´ –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Ø

### –ü—Ä–∏–º–µ—Ä 1: –¢—É—Ä–∏—Å—Ç —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç—Å—è

1. –ó–∞—Ö–æ–¥–∏—Ç –Ω–∞ `/auth/register`
2. –ù–∞–∂–∏–º–∞–µ—Ç "–Ø —Ç—É—Ä–∏—Å—Ç"
3. –ó–∞–ø–æ–ª–Ω—è–µ—Ç —Ñ–æ—Ä–º—É:
   - –ò–º—è: –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤
   - Email: ivan@mail.ru
   - –ü–∞—Ä–æ–ª—å: mypassword
4. –ù–∞–∂–∏–º–∞–µ—Ç "–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è"
5. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ª—É—á–∞–µ—Ç —Ä–æ–ª—å `['tourist']`
6. –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –Ω–∞ `/hub/tourist`

---

### –ü—Ä–∏–º–µ—Ä 2: –ë–∏–∑–Ω–µ—Å —Å –æ–¥–Ω–æ–π —Ä–æ–ª—å—é

1. –ó–∞—Ö–æ–¥–∏—Ç –Ω–∞ `/auth/register`
2. –ù–∞–∂–∏–º–∞–µ—Ç "–î–ª—è –±–∏–∑–Ω–µ—Å–∞"
3. **–®–∞–≥ 1:** –í—ã–±–∏—Ä–∞–µ—Ç —Ä–æ–ª—å "–¢—É—Ä–æ–ø–µ—Ä–∞—Ç–æ—Ä"
4. –ù–∞–∂–∏–º–∞–µ—Ç "–î–∞–ª–µ–µ"
5. **–®–∞–≥ 2:** –ó–∞–ø–æ–ª–Ω—è–µ—Ç –¥–∞–Ω–Ω—ã–µ:
   - –ò–º—è: –ü–µ—Ç—Ä –ü–µ—Ç—Ä–æ–≤
   - –ö–æ–º–ø–∞–Ω–∏—è: –û–û–û "–ö–∞–º—á–∞—Ç–∫–∞ –¢—É—Ä"
   - Email: info@kamtour.ru
   - –¢–µ–ª–µ—Ñ–æ–Ω: +7 999 123 45 67
   - –ü–∞—Ä–æ–ª—å: securepass123
6. –ù–∞–∂–∏–º–∞–µ—Ç "–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è"
7. –ü–æ–ª—É—á–∞–µ—Ç —Ä–æ–ª—å `['operator']`
8. –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –Ω–∞ `/hub/tour-operator`

---

### –ü—Ä–∏–º–µ—Ä 3: –ë–∏–∑–Ω–µ—Å —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ —Ä–æ–ª—è–º–∏

1. –ó–∞—Ö–æ–¥–∏—Ç –Ω–∞ `/auth/register`
2. –ù–∞–∂–∏–º–∞–µ—Ç "–î–ª—è –±–∏–∑–Ω–µ—Å–∞"
3. **–®–∞–≥ 1:** –í—ã–±–∏—Ä–∞–µ—Ç —Ä–æ–ª–∏:
   - ‚úÖ –¢—É—Ä–æ–ø–µ—Ä–∞—Ç–æ—Ä
   - ‚úÖ –ì–∏–¥
   - ‚úÖ –í–æ–¥–∏—Ç–µ–ª—å
4. –ù–∞–∂–∏–º–∞–µ—Ç "–î–∞–ª–µ–µ"
5. **–®–∞–≥ 2:** –ó–∞–ø–æ–ª–Ω—è–µ—Ç –¥–∞–Ω–Ω—ã–µ
6. –ù–∞–∂–∏–º–∞–µ—Ç "–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è"
7. –ü–æ–ª—É—á–∞–µ—Ç —Ä–æ–ª–∏ `['operator', 'guide', 'driver']`
8. Primary role: `'operator'`
9. –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –Ω–∞ `/hub/tour-operator`
10. **–ú–æ–∂–µ—Ç –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç—å—Å—è –º–µ–∂–¥—É –¥–∞—à–±–æ—Ä–¥–∞–º–∏** –≤—Å–µ—Ö —Å–≤–æ–∏—Ö —Ä–æ–ª–µ–π

---

## üîê –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨

### –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è email
- ‚úÖ –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ –ø–∞—Ä–æ–ª—è (6 —Å–∏–º–≤–æ–ª–æ–≤)
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è –ø–∞—Ä–æ–ª–µ–π
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏ email
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–æ–ø—É—Å—Ç–∏–º—ã—Ö —Ä–æ–ª–µ–π
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è —Ö–æ—Ç—è –±—ã –æ–¥–Ω–æ–π —Ä–æ–ª–∏

### TODO (–¥–ª—è production):
- [ ] –•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π (bcrypt)
- [ ] Email verification
- [ ] Rate limiting –Ω–∞ API
- [ ] CAPTCHA (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- [ ] 2FA (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

---

## üöÄ –ö–ê–ö –ò–°–ü–û–õ–¨–ó–û–í–ê–¢–¨

### –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤:

1. **–ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é –ë–î:**
```bash
psql -h your-host -d kamchatour_hub -f lib/database/user_roles_migration.sql
```

2. **–û–±–Ω–æ–≤–∏—Ç—å —Ä–æ—É—Ç—ã:**
```typescript
// –î–æ–±–∞–≤–∏—Ç—å —Å—Å—ã–ª–∫–∏ –Ω–∞ –Ω–æ–≤—ã–µ —Ñ–æ—Ä–º—ã
<Link href="/auth/register">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</Link>
<Link href="/auth/register-tourist">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è –∫–∞–∫ —Ç—É—Ä–∏—Å—Ç</Link>
<Link href="/auth/register-business">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è –¥–ª—è –±–∏–∑–Ω–µ—Å–∞</Link>
```

3. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ –∫–æ–¥–µ:**
```typescript
// –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–æ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
const user = getCurrentUser();
const hasOperatorRole = user.roles.includes('operator');

// –ü–æ–ª—É—á–∏—Ç—å primary role
const primaryRole = user.primaryRole; // –∏–ª–∏ user.roles[0]

// SQL –∑–∞–ø—Ä–æ—Å
const operators = await query(`
  SELECT * FROM users 
  WHERE roles @> '["operator"]'
`);
```

---

### –î–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:

**–¢—É—Ä–∏—Å—Ç:**
```
1. –ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ /auth/register
2. –í—ã–±—Ä–∞—Ç—å "–Ø —Ç—É—Ä–∏—Å—Ç"
3. –ó–∞–ø–æ–ª–Ω–∏—Ç—å —Ñ–æ—Ä–º—É (–∏–º—è, email, –ø–∞—Ä–æ–ª—å)
4. –ì–æ—Ç–æ–≤–æ! ‚Üí /hub/tourist
```

**–ë–∏–∑–Ω–µ—Å:**
```
1. –ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ /auth/register
2. –í—ã–±—Ä–∞—Ç—å "–î–ª—è –±–∏–∑–Ω–µ—Å–∞"
3. –í—ã–±—Ä–∞—Ç—å –æ–¥–Ω—É –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–æ–ª–µ–π
4. –ó–∞–ø–æ–ª–Ω–∏—Ç—å –∫–æ–Ω—Ç–∞–∫—Ç–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
5. –ì–æ—Ç–æ–≤–æ! ‚Üí —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π –¥–∞—à–±–æ—Ä–¥
```

---

## üì± –ê–î–ê–ü–¢–ò–í–ù–û–°–¢–¨

### Desktop (‚â•768px):
- 2 –∫–æ–ª–æ–Ω–∫–∏ –¥–ª—è –∫–∞—Ä—Ç–æ—á–µ–∫ —Ä–æ–ª–µ–π
- 2 –∫–æ–ª–æ–Ω–∫–∏ –¥–ª—è Email/Phone –∏ Password/Confirm
- –ü–æ–ª–Ω–æ—Ä–∞–∑–º–µ—Ä–Ω—ã–µ —Ñ–æ—Ä–º—ã

### Mobile (<768px):
- 1 –∫–æ–ª–æ–Ω–∫–∞ –¥–ª—è –≤—Å–µ—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
- –ö–æ–º–ø–∞–∫—Ç–Ω—ã–µ –∫–Ω–æ–ø–∫–∏
- –°–∫—Ä—ã–≤–∞—é—Ç—Å—è –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –º–µ—Ç–∫–∏

---

## üéØ –ò–¢–û–ì–û

### –°–æ–∑–¥–∞–Ω–æ —Ñ–∞–π–ª–æ–≤: **4**

```
‚úÖ /lib/database/user_roles_migration.sql       - –ú–∏–≥—Ä–∞—Ü–∏—è –ë–î
‚úÖ /app/auth/register/page.tsx                  - –°—Ç—Ä–∞–Ω–∏—Ü–∞ –≤—ã–±–æ—Ä–∞
‚úÖ /app/auth/register-tourist/page.tsx          - –§–æ—Ä–º–∞ —Ç—É—Ä–∏—Å—Ç–∞
‚úÖ /app/auth/register-business/page.tsx         - –§–æ—Ä–º–∞ –±–∏–∑–Ω–µ—Å–∞
```

### –û–±–Ω–æ–≤–ª–µ–Ω–æ —Ñ–∞–π–ª–æ–≤: **1**

```
‚úÖ /app/api/auth/signup/route.ts                - API —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
```

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:

```
–°—Ç—Ä–æ–∫ –∫–æ–¥–∞:        ~800
–ö–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤:       3 —Å—Ç—Ä–∞–Ω–∏—Ü—ã
API endpoints:     1 –æ–±–Ω–æ–≤–ª–µ–Ω
–ë–î —Ñ—É–Ω–∫—Ü–∏–π:        3 –Ω–æ–≤—ã—Ö
–ë–î –∏–Ω–¥–µ–∫—Å–æ–≤:       1 –Ω–æ–≤—ã–π
```

---

## ‚úÖ –ß–ï–ö–õ–ò–°–¢ –ì–û–¢–û–í–ù–û–°–¢–ò

- [x] –ú–∏–≥—Ä–∞—Ü–∏—è –ë–î –¥–ª—è –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Ä–æ–ª–µ–π
- [x] –§—É–Ω–∫—Ü–∏–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —Ä–æ–ª–µ–π
- [x] –§–æ—Ä–º–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ —Ç—É—Ä–∏—Å—Ç–∞
- [x] –§–æ—Ä–º–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –±–∏–∑–Ω–µ—Å–∞
- [x] –°—Ç—Ä–∞–Ω–∏—Ü–∞ –≤—ã–±–æ—Ä–∞ —Ç–∏–ø–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
- [x] API –æ–±–Ω–æ–≤–ª–µ–Ω –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –º–∞—Å—Å–∏–≤–∞ —Ä–æ–ª–µ–π
- [x] –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö –ø–æ–ª–µ–π
- [x] –°–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö
- [x] Loading —Å–æ—Å—Ç–æ—è–Ω–∏—è
- [x] –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –¥–∏–∑–∞–π–Ω
- [x] Lucide-react –∏–∫–æ–Ω–∫–∏
- [x] Premium —Å—Ç–∏–ª—å
- [x] –ê–Ω–∏–º–∞—Ü–∏–∏ –∏ transitions
- [x] –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –¥–∞—à–±–æ—Ä–¥—ã

---

## üéâ –ì–û–¢–û–í–û –ö –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Æ!

**–°–∏—Å—Ç–µ–º–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞:**
- ‚úÖ –¢—É—Ä–∏—Å—Ç—ã —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É—é—Ç—Å—è –±—ã—Å—Ç—Ä–æ –∏ –ø—Ä–æ—Å—Ç–æ
- ‚úÖ –ë–∏–∑–Ω–µ—Å –≤—ã–±–∏—Ä–∞–µ—Ç –æ–¥–Ω—É –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–æ–ª–µ–π
- ‚úÖ –ö—Ä–∞—Å–∏–≤—ã–π —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π UI
- ‚úÖ –ü–æ–ª–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Ä–æ–ª–µ–π –≤ –ë–î

---

**–î–∞—Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è:** 2025-11-04  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ Production Ready
