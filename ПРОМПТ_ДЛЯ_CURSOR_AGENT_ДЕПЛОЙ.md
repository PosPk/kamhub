# üöÄ –ü–†–û–ú–ü–¢ –î–õ–Ø CURSOR AGENT: –î–ï–ü–õ–û–ô KAMHUB

---

## üìã –ó–ê–î–ê–ß–ê

–í—ã–ø–æ–ª–Ω–∏ –ø–æ–ª–Ω—ã–π –¥–µ–ø–ª–æ–π –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è **KamHub** –Ω–∞ Timeweb VDS —Å–µ—Ä–≤–µ—Ä —Å IP `5.129.248.224`.

---

## ‚úÖ –ß–¢–û –£–ñ–ï –ì–û–¢–û–í–û

### **1. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è —É—Å–ø–µ—à–Ω–æ**
```bash
npm run build
# ‚úì Compiled successfully
# ‚úì Generating static pages (20/20)
```

### **2. –í—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã:**
- ‚úÖ –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ (`app/page.tsx`)
- ‚úÖ Layout —Å header (`app/layout.tsx`)
- ‚úÖ –í—Å–µ Hub —Å—Ç—Ä–∞–Ω–∏—Ü—ã (tourist, operator, guide, transfer, etc.)
- ‚úÖ –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã (TourCard, WeatherWidget, EcoPointsWidget, AIChatWidget)
- ‚úÖ API routes (23 endpoints)
- ‚úÖ –î–∏–∑–∞–π–Ω (Premium Black & Gold theme)
- ‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (PostgreSQL schemas)

### **3. –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:**
- ‚úÖ `–ö–ê–†–¢–ê_–ù–ê–í–ò–ì–ê–¶–ò–ò_–ò_–°–¢–†–ê–ù–ò–¶.md` - –ü–æ–ª–Ω–∞—è –∫–∞—Ä—Ç–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- ‚úÖ `–î–ò–ó–ê–ô–ù_–ì–õ–ê–í–ù–û–ô_–°–¢–†–ê–ù–ò–¶–´.md` - –î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –¥–∏–∑–∞–π–Ω–∞
- ‚úÖ `–ü–û–õ–ù–´–ô_–ê–ù–ê–õ–ò–ó_–†–û–õ–ï–ô_–ò_–ë–ò–ó–ù–ï–°_–ü–†–û–¶–ï–°–°–û–í.md` - –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- ‚úÖ `operators_schema.sql` - –°—Ö–µ–º–∞ –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤ (–∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ)

### **4. –î–æ—Å—Ç—É–ø—ã –∫ —Å–µ—Ä–≤–µ—Ä—É:**
```
IP: 5.129.248.224
User: root
Password: xQvB1pv?yZTjaR
SSH: ssh root@5.129.248.224
```

### **5. Timeweb API Token:**
```
eyJhbGciOiJSUzUxMiIsInR5cCI6IkpXVCIsImtpZCI6IjFrYnhacFJNQGJSI0tSbE1xS1lqIn0...
```

### **6. S3 Bucket (–¥–ª—è —Ñ–∞–π–ª–æ–≤):**
```
Endpoint: https://s3.timeweb.cloud/
Bucket: d9542536-676ee691-7f59-46bb-bf0e-ab64230eec50
Access Key: F2CP4X3X17GVQ1YH5I5D
Secret Key: 72iAsYR4QQCIdaDI9e9AzXnzVvvP8bvPELmrBVzX
```

---

## üéØ –ß–¢–û –ù–£–ñ–ù–û –°–î–ï–õ–ê–¢–¨

### **–®–ê–ì 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ (–µ—Å–ª–∏ –Ω–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ)**

#### **1.1. –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–µ—Ä–≤–µ—Ä—É:**
```bash
# –ò—Å–ø–æ–ª—å–∑—É–π Timeweb Web Console (https://timeweb.cloud/my/servers)
# –ò–ª–∏ SSH (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω –∏–∑ —Ç–≤–æ–µ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è):
ssh root@5.129.248.224
# –ü–∞—Ä–æ–ª—å: xQvB1pv?yZTjaR
```

#### **1.2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π:**
```bash
# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã
apt-get update && apt-get upgrade -y

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Node.js 20.x
curl -fsSL https://deb.nodesource.com/setup_20.x | bash -
apt-get install -y nodejs

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ PostgreSQL 15
apt-get install -y postgresql postgresql-contrib postgis

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Nginx
apt-get install -y nginx

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ PM2 (–¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è Node.js –ø—Ä–æ—Ü–µ—Å—Å–æ–º)
npm install -g pm2

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Git
apt-get install -y git
```

---

### **–®–ê–ì 2: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ PostgreSQL**

#### **2.1. –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:**
```bash
# –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º—Å—è –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è postgres
sudo -u postgres psql

# –í psql –≤—ã–ø–æ–ª–Ω—è–µ–º:
CREATE USER kamhub WITH PASSWORD 'kamhub_secure_password_2025';
CREATE DATABASE kamhub OWNER kamhub;
GRANT ALL PRIVILEGES ON DATABASE kamhub TO kamhub;

# –í–∫–ª—é—á–∞–µ–º PostGIS
\c kamhub
CREATE EXTENSION IF NOT EXISTS postgis;
CREATE EXTENSION IF NOT EXISTS "uuid-ossp";

# –í—ã—Ö–æ–¥–∏–º
\q
```

#### **2.2. –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π:**
```bash
# –ü–µ—Ä–µ—Ö–æ–¥–∏–º –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ø—Ä–æ–µ–∫—Ç–∞ (–ø–æ—Å–ª–µ –∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è)
cd /var/www/kamhub

# –ü—Ä–∏–º–µ–Ω—è–µ–º –≤—Å–µ SQL —Å—Ö–µ–º—ã
sudo -u postgres psql -d kamhub -f lib/database/schema.sql
sudo -u postgres psql -d kamhub -f lib/database/operators_schema.sql
sudo -u postgres psql -d kamhub -f lib/database/transfer_schema.sql
sudo -u postgres psql -d kamhub -f lib/database/loyalty_schema.sql
sudo -u postgres psql -d kamhub -f lib/database/transfer_payments_schema.sql

# –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–∞–±–ª–∏—Ü—ã
sudo -u postgres psql -d kamhub -c "\dt"
```

---

### **–®–ê–ì 3: –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —Å–±–æ—Ä–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è**

#### **3.1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è:**
```bash
# –°–æ–∑–¥–∞—ë–º –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é
mkdir -p /var/www
cd /var/www

# –ö–ª–æ–Ω–∏—Ä—É–µ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
git clone https://github.com/PosPk/kamhub.git
cd kamhub

# –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º—Å—è –Ω–∞ main –≤–µ—Ç–∫—É
git checkout main
git pull origin main
```

#### **3.2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π:**
```bash
# –û—á–∏—Å—Ç–∫–∞ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
rm -rf node_modules package-lock.json .next

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞
npm ci
```

#### **3.3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ .env:**
```bash
cat > .env << 'EOF'
# Database
DATABASE_URL=postgresql://kamhub:kamhub_secure_password_2025@localhost:5432/kamhub

# Server
NODE_ENV=production
PORT=3000
NEXT_PUBLIC_API_URL=http://5.129.248.224:3000

# Timeweb API
TIMEWEB_API_TOKEN=eyJhbGciOiJSUzUxMiIsInR5cCI6IkpXVCIsImtpZCI6IjFrYnhacFJNQGJSI0tSbE1xS1lqIn0.eyJ1c2VyIjoicGE0MjIxMDgiLCJ0eXBlIjoiYXBpX2tleSIsImFwaV9rZXlfaWQiOiI0MmZmZTY1MC02OWI4LTRmZmQtYTFkOC02OWRkMjMwM2QyY2MiLCJpYXQiOjE3NjE3ODUzNDl9.SFHpwgy9kr-EH2CwN6K1REkOl7KCpiUnMk5ivTRljEaWl8iE-B-BMjaJxaFhpdB2dqcb33ky2oyfwxkU1Sszrbo-8UINnFO5SothY4P6WC8kSSHxFlLI2i0xGCa3YzgyYZ1Wgn2a0jf__ZcyZi7ZsaJkuold9NAeeGCCrAUbdVsr39-fLDL_EKh0iekq_tuO59f_BCmg7Poe7xKlmNYzu2hy3GnfNp3ueKW52H6kFkGwibixS3tWKCHkPpyTAjRztWKCnDZOOG6xDk4sSiPPMlZOEfFzzkpKkizQ9CykBC06SXwmT2uPRR2NyZJIY-PZd4AVZ34H1jXQ-NGquRPi_aYiywt3LtOVDRarpVErBdk6I0qO0Yf33zICvMN-yFpXuY_oSlE8v3C-02XHnYLsMXcHTsUB4ISkJrhglBkv-hTzuiQxwAEZp0eHOEq8YNz6qOLU3RcaNgg0DWGXMDrMzObYx2NknrZUCMbRFftIU-C1Ilo8Ayy98MwI3J77X62p

# S3 Storage
S3_ENDPOINT=https://s3.timeweb.cloud
S3_BUCKET=d9542536-676ee691-7f59-46bb-bf0e-ab64230eec50
S3_ACCESS_KEY=F2CP4X3X17GVQ1YH5I5D
S3_SECRET_KEY=72iAsYR4QQCIdaDI9e9AzXnzVvvP8bvPELmrBVzX
S3_REGION=ru-1

# SMS.ru (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –¥–ª—è SMS —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π)
# SMS_RU_API_KEY=your_sms_ru_api_key

# AWS SES (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –¥–ª—è email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π)
# AWS_SES_REGION=eu-west-1
# AWS_SES_ACCESS_KEY=your_ses_access_key
# AWS_SES_SECRET_KEY=your_ses_secret_key
# AWS_SES_FROM_EMAIL=noreply@kamhub.ru

# Telegram Bot (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –¥–ª—è Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π)
# TELEGRAM_BOT_TOKEN=your_bot_token

# Groq API (–¥–ª—è AI-—á–∞—Ç–∞)
# GROQ_API_KEY=your_groq_api_key

# Deepseek API (fallback –¥–ª—è AI)
# DEEPSEEK_API_KEY=your_deepseek_api_key

# JWT Secret (–¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏)
JWT_SECRET=kamhub_jwt_secret_super_secure_2025_change_me_in_production

# Yandex Maps API (–¥–ª—è –∫–∞—Ä—Ç)
# YANDEX_MAPS_API_KEY=your_yandex_maps_key

# CloudPayments (–¥–ª—è –æ–ø–ª–∞—Ç—ã)
# CLOUDPAYMENTS_PUBLIC_ID=your_public_id
# CLOUDPAYMENTS_API_SECRET=your_api_secret
EOF
```

#### **3.4. –°–±–æ—Ä–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:**
```bash
npm run build
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```
‚úì Compiled successfully
‚úì Generating static pages (20/20)
‚úì Finalizing page optimization
```

---

### **–®–ê–ì 4: –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Å PM2**

#### **4.1. –°–æ–∑–¥–∞–Ω–∏–µ ecosystem.config.js:**
```bash
cat > ecosystem.config.js << 'EOF'
module.exports = {
  apps: [{
    name: 'kamhub',
    script: 'npm',
    args: 'start',
    cwd: '/var/www/kamhub',
    instances: 2,
    exec_mode: 'cluster',
    env: {
      NODE_ENV: 'production',
      PORT: 3000
    },
    error_file: '/var/log/kamhub/error.log',
    out_file: '/var/log/kamhub/out.log',
    log_file: '/var/log/kamhub/combined.log',
    time: true,
    max_memory_restart: '500M',
    autorestart: true,
    watch: false
  }]
};
EOF
```

#### **4.2. –°–æ–∑–¥–∞–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –¥–ª—è –ª–æ–≥–æ–≤:**
```bash
mkdir -p /var/log/kamhub
chown -R root:root /var/log/kamhub
```

#### **4.3. –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:**
```bash
# –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–π –ø—Ä–æ—Ü–µ—Å—Å (–µ—Å–ª–∏ –±—ã–ª)
pm2 delete kamhub || true

# –ó–∞–ø—É—Å–∫–∞–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
pm2 start ecosystem.config.js

# –°–æ—Ö—Ä–∞–Ω—è–µ–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é PM2 –¥–ª—è –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫–∞
pm2 save
pm2 startup systemd

# –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞—Ç—É—Å
pm2 status
pm2 logs kamhub --lines 50
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ id ‚îÇ name       ‚îÇ mode        ‚îÇ ‚Ü∫       ‚îÇ status  ‚îÇ cpu      ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ 0  ‚îÇ kamhub     ‚îÇ cluster     ‚îÇ 0       ‚îÇ online  ‚îÇ 0%       ‚îÇ
‚îÇ 1  ‚îÇ kamhub     ‚îÇ cluster     ‚îÇ 0       ‚îÇ online  ‚îÇ 0%       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

### **–®–ê–ì 5: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Nginx (Reverse Proxy)**

#### **5.1. –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Nginx:**
```bash
cat > /etc/nginx/sites-available/kamhub << 'EOF'
server {
    listen 80;
    server_name 5.129.248.224;

    # –õ–æ–≥–∏
    access_log /var/log/nginx/kamhub_access.log;
    error_log /var/log/nginx/kamhub_error.log;

    # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –∑–∞–≥—Ä—É–∂–∞–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤
    client_max_body_size 50M;

    # Proxy –¥–ª—è Next.js –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
    location / {
        proxy_pass http://127.0.0.1:3000;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_cache_bypass $http_upgrade;
        
        # –¢–∞–π–º–∞—É—Ç—ã
        proxy_connect_timeout 60s;
        proxy_send_timeout 60s;
        proxy_read_timeout 60s;
    }

    # –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤
    location /_next/static/ {
        proxy_pass http://127.0.0.1:3000;
        proxy_cache_valid 200 60m;
        proxy_cache_bypass $http_pragma $http_authorization;
        expires 1y;
        add_header Cache-Control "public, immutable";
    }

    # –ü—É–±–ª–∏—á–Ω—ã–µ —Ñ–∞–π–ª—ã
    location /graphics/ {
        proxy_pass http://127.0.0.1:3000;
        expires 1y;
        add_header Cache-Control "public, immutable";
    }
}
EOF
```

#### **5.2. –ê–∫—Ç–∏–≤–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:**
```bash
# –°–æ–∑–¥–∞—ë–º —Å–∏–º–≤–æ–ª–∏—á–µ—Å–∫—É—é —Å—Å—ã–ª–∫—É
ln -sf /etc/nginx/sites-available/kamhub /etc/nginx/sites-enabled/kamhub

# –£–¥–∞–ª—è–µ–º –¥–µ—Ñ–æ–ª—Ç–Ω—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
rm -f /etc/nginx/sites-enabled/default

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
nginx -t

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ–º Nginx
systemctl restart nginx
systemctl enable nginx
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```
nginx: the configuration file /etc/nginx/nginx.conf syntax is ok
nginx: configuration file /etc/nginx/nginx.conf test is successful
```

---

### **–®–ê–ì 6: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Firewall (UFW)**

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ UFW (–µ—Å–ª–∏ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω)
apt-get install -y ufw

# –†–∞–∑—Ä–µ—à–∞–µ–º SSH (–í–ê–ñ–ù–û! –ò–Ω–∞—á–µ –ø–æ—Ç–µ—Ä—è–µ–º –¥–æ—Å—Ç—É–ø)
ufw allow 22/tcp

# –†–∞–∑—Ä–µ—à–∞–µ–º HTTP
ufw allow 80/tcp

# –†–∞–∑—Ä–µ—à–∞–µ–º HTTPS (–¥–ª—è –±—É–¥—É—â–µ–≥–æ SSL)
ufw allow 443/tcp

# –í–∫–ª—é—á–∞–µ–º firewall
ufw --force enable

# –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞—Ç—É—Å
ufw status verbose
```

---

### **–®–ê–ì 7: –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–µ–ø–ª–æ—è**

#### **7.1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–∫–∞–ª—å–Ω–æ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:**
```bash
# –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
curl -I http://127.0.0.1:3000

# –ü—Ä–æ–≤–µ—Ä—è–µ–º —á–µ—Ä–µ–∑ Nginx
curl -I http://127.0.0.1:80
```

#### **7.2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–∑–≤–Ω–µ:**
```bash
# –° —Ç–≤–æ–µ–π –º–∞—à–∏–Ω—ã (–∏–ª–∏ –∏–∑ –±—Ä–∞—É–∑–µ—Ä–∞)
curl -I http://5.129.248.224
```

#### **7.3. –û—Ç–∫—Ä—ã–≤–∞–µ–º –≤ –±—Ä–∞—É–∑–µ—Ä–µ:**
```
http://5.129.248.224
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è
- ‚úÖ –í–∏–¥–Ω–æ –≤–∏–¥–µ–æ Hero section
- ‚úÖ –ó–æ–ª–æ—Ç–æ–π –¥–∏–∑–∞–π–Ω (Premium Black & Gold)
- ‚úÖ –ö–∞—Ä—Ç–æ—á–∫–∏ —Ç—É—Ä–æ–≤ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è
- ‚úÖ –í–∏–¥–∂–µ—Ç—ã –ø–æ–≥–æ–¥—ã –∏ Eco-points —Ä–∞–±–æ—Ç–∞—é—Ç

---

### **–®–ê–ì 8: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏**

#### **8.1. –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:**
```bash
# PM2 –ª–æ–≥–∏ (–≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏)
pm2 logs kamhub

# PM2 –ª–æ–≥–∏ (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 100 —Å—Ç—Ä–æ–∫)
pm2 logs kamhub --lines 100

# –§–∞–π–ª—ã –ª–æ–≥–æ–≤
tail -f /var/log/kamhub/out.log
tail -f /var/log/kamhub/error.log
```

#### **8.2. –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ Nginx:**
```bash
tail -f /var/log/nginx/kamhub_access.log
tail -f /var/log/nginx/kamhub_error.log
```

#### **8.3. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ PM2:**
```bash
pm2 monit
```

---

## üîß –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –ö–û–ú–ê–ù–î–´

### **–ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:**
```bash
cd /var/www/kamhub
git pull origin main
npm ci
npm run build
pm2 restart kamhub
```

### **–û—Å—Ç–∞–Ω–æ–≤–∫–∞/–∑–∞–ø—É—Å–∫:**
```bash
pm2 stop kamhub
pm2 start kamhub
pm2 restart kamhub
```

### **–û—á–∏—Å—Ç–∫–∞ –∏ –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∞:**
```bash
cd /var/www/kamhub
rm -rf .next node_modules
npm ci
npm run build
pm2 restart kamhub
```

---

## ‚ö†Ô∏è –í–ê–ñ–ù–´–ï –ó–ê–ú–ï–ß–ê–ù–ò–Ø

### **1. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:**
- ‚ö†Ô∏è **–ò–∑–º–µ–Ω–∏ –ø–∞—Ä–æ–ª—å PostgreSQL** –≤ production!
- ‚ö†Ô∏è **–ò–∑–º–µ–Ω–∏ JWT_SECRET** –≤ `.env`!
- ‚ö†Ô∏è **–ù–∞—Å—Ç—Ä–æ–π SSL/TLS** (Let's Encrypt) –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –¥–µ–ø–ª–æ—è

### **2. Performance:**
- ‚úÖ PM2 –∑–∞–ø—É—Å–∫–∞–µ—Ç 2 –∏–Ω—Å—Ç–∞–Ω—Å–∞ (cluster mode)
- ‚úÖ Nginx –∫—ç—à–∏—Ä—É–µ—Ç —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã
- ‚úÖ PostgreSQL –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω (indexes, triggers)

### **3. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:**
- üìä PM2 –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏
- üìä –õ–æ–≥–∏ –ø–∏—à—É—Ç—Å—è –≤ `/var/log/kamhub/`
- üìä Nginx –ª–æ–≥–∏—Ä—É–µ—Ç –≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã

---

## üéØ –ß–ï–ö–õ–ò–°–¢ –ü–û–°–õ–ï –î–ï–ü–õ–û–Ø

```bash
# 1. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
curl -I http://5.129.248.224
# –û–∂–∏–¥–∞–µ–º: HTTP/1.1 200 OK

# 2. PM2 —Å—Ç–∞—Ç—É—Å "online"
pm2 status
# –û–∂–∏–¥–∞–µ–º: status: online (2 –∏–Ω—Å—Ç–∞–Ω—Å–∞)

# 3. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ–¥–∫–ª—é—á–µ–Ω–∞
sudo -u postgres psql -d kamhub -c "SELECT COUNT(*) FROM users;"
# –û–∂–∏–¥–∞–µ–º: count (0 –∏–ª–∏ –±–æ–ª—å—à–µ)

# 4. Nginx —Ä–∞–±–æ—Ç–∞–µ—Ç
systemctl status nginx
# –û–∂–∏–¥–∞–µ–º: active (running)

# 5. Firewall –Ω–∞—Å—Ç—Ä–æ–µ–Ω
ufw status
# –û–∂–∏–¥–∞–µ–º: Status: active, 80/tcp ALLOW

# 6. –ù–µ—Ç –æ—à–∏–±–æ–∫ –≤ –ª–æ–≥–∞—Ö
pm2 logs kamhub --lines 20 --err
# –û–∂–∏–¥–∞–µ–º: –Ω–µ—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫
```

---

## üöÄ –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–û: SSL/TLS (HTTPS)

### **–£—Å—Ç–∞–Ω–æ–≤–∫–∞ Certbot (Let's Encrypt):**
```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Certbot
apt-get install -y certbot python3-certbot-nginx

# –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ (–í–ê–ñ–ù–û: –Ω—É–∂–µ–Ω –¥–æ–º–µ–Ω!)
# –î–ª—è IP –∞–¥—Ä–µ—Å–∞ Let's Encrypt –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç!
# –ü–æ—ç—Ç–æ–º—É –ø–æ–∫–∞ –∏—Å–ø–æ–ª—å–∑—É–µ–º HTTP, –∞ HTTPS –Ω–∞—Å—Ç—Ä–æ–∏–º –ø–æ—Å–ª–µ –ø—Ä–∏–≤—è–∑–∫–∏ –¥–æ–º–µ–Ω–∞

# –ï—Å–ª–∏ –µ—Å—Ç—å –¥–æ–º–µ–Ω (–Ω–∞–ø—Ä–∏–º–µ—Ä, kamhub.ru):
# certbot --nginx -d kamhub.ru -d www.kamhub.ru
# certbot renew --dry-run
```

---

## üìù –û–ñ–ò–î–ê–ï–ú–´–ô –†–ï–ó–£–õ–¨–¢–ê–¢

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Å–µ—Ö —à–∞–≥–æ–≤:

‚úÖ **–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–Ω–æ:** `http://5.129.248.224`  
‚úÖ **–î–∏–∑–∞–π–Ω —Ä–∞–±–æ—Ç–∞–µ—Ç:** Premium Black & Gold theme  
‚úÖ **Hero section:** –í–∏–¥–µ–æ + Aurora animation  
‚úÖ **–¢—É—Ä—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è:** API `/api/tours` —Ä–∞–±–æ—Ç–∞–µ—Ç  
‚úÖ **–í–∏–¥–∂–µ—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç:** –ü–æ–≥–æ–¥–∞, Eco-points  
‚úÖ **AI-—á–∞—Ç:** –ú–æ–∂–µ—Ç –æ—Ç–≤–µ—á–∞—Ç—å (–µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω GROQ_API_KEY)  
‚úÖ **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:** PostgreSQL + PostGIS  
‚úÖ **–ê–≤—Ç–æ–∑–∞–ø—É—Å–∫:** PM2 + systemd  
‚úÖ **Reverse proxy:** Nginx  
‚úÖ **Firewall:** UFW –Ω–∞—Å—Ç—Ä–æ–µ–Ω  

---

## üÜò TROUBLESHOOTING

### **–ü—Ä–æ–±–ª–µ–º–∞: –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è**
```bash
# –ü—Ä–æ–≤–µ—Ä—è–µ–º –ª–æ–≥–∏ PM2
pm2 logs kamhub --err

# –ü—Ä–æ–≤–µ—Ä—è–µ–º .env —Ñ–∞–π–ª
cat /var/www/kamhub/.env

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î
cd /var/www/kamhub
node -e "const { Pool } = require('pg'); const pool = new Pool({ connectionString: process.env.DATABASE_URL }); pool.query('SELECT NOW()', (err, res) => { console.log(err || res.rows); pool.end(); });"
```

### **–ü—Ä–æ–±–ª–µ–º–∞: Nginx –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç 502 Bad Gateway**
```bash
# –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—â–µ–Ω–æ
pm2 status

# –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –ø–æ—Ä—Ç 3000 —Å–ª—É—à–∞–µ—Ç—Å—è
netstat -tlnp | grep 3000

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ–º
pm2 restart kamhub
systemctl restart nginx
```

### **–ü—Ä–æ–±–ª–µ–º–∞: –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è**
```bash
# –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞—Ç—É—Å PostgreSQL
systemctl status postgresql

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
sudo -u postgres psql -d kamhub -c "SELECT 1;"

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–∞—Ä–æ–ª—å –≤ .env
grep DATABASE_URL /var/www/kamhub/.env
```

---

**–ü–†–û–ú–ü–¢ –ì–û–¢–û–í!** üöÄ  
**–í—ã–ø–æ–ª–Ω–∏ –≤—Å–µ —à–∞–≥–∏ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ, –∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±—É–¥–µ—Ç –∑–∞–¥–µ–ø–ª–æ–µ–Ω–æ!** ‚úÖ
