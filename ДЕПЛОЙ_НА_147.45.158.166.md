# üöÄ –î–ï–ü–õ–û–ô KAMHUB –ù–ê PRODUCTION –°–ï–†–í–ï–†
## IP: 147.45.158.166

**–î–∞—Ç–∞:** 26 –Ω–æ—è–±—Ä—è 2025  
**–°—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–µ—Ä–∞:** ‚úÖ –û–ù–õ–ê–ô–ù (ping: 176ms, 0% –ø–æ—Ç–µ—Ä—å)  
**–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å:** ‚úÖ –ì–û–¢–û–í –ö –î–ï–ü–õ–û–Æ

---

## üìã –î–ê–ù–ù–´–ï –î–û–°–¢–£–ü–ê

```
IP:       147.45.158.166
User:     root
Password: eiGo@VK4.,,VH7
SSH:      ssh root@147.45.158.166
```

---

## ‚ö° –ë–´–°–¢–†–´–ô –î–ï–ü–õ–û–ô (3 –ö–û–ú–ê–ù–î–´)

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π (–†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø)

#### –®–ê–ì 1: –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É

```bash
ssh root@147.45.158.166
# –ü–∞—Ä–æ–ª—å: eiGo@VK4.,,VH7
```

#### –®–ê–ì 2: –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–¥–µ–ø–ª–æ—è

```bash
# –°–∫–∞—á–∞—Ç—å —Å–∫—Ä–∏–ø—Ç
curl -o deploy.sh https://raw.githubusercontent.com/PosPk/kamhub/main/deploy-timeweb.sh

# –°–¥–µ–ª–∞—Ç—å –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º
chmod +x deploy.sh

# –ó–∞–ø—É—Å—Ç–∏—Ç—å (10-15 –º–∏–Ω—É—Ç)
bash deploy.sh
```

**–°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:**
- ‚úÖ –û–±–Ω–æ–≤–∏—Ç —Å–∏—Å—Ç–µ–º—É
- ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–∏—Ç Node.js 20
- ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–∏—Ç PostgreSQL
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–∏—Ç –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–∏—Ç Nginx
- ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–∏—Ç PM2
- ‚úÖ –ö–ª–æ–Ω–∏—Ä—É–µ—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
- ‚úÖ –°–æ–±–µ—Ä–µ—Ç –ø—Ä–æ–µ–∫—Ç
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–∏—Ç –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫

#### –®–ê–ì 3: –ó–∞–ø–æ–ª–Ω–∏—Ç—å API –∫–ª—é—á–∏

```bash
cd /var/www/kamchatour
nano .env
```

**–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è .env:**

```env
# ===================================
# DATABASE (–±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
# ===================================
DATABASE_URL=postgresql://kamuser:GENERATED_PASSWORD@localhost:5432/kamchatour

# ===================================
# NEXT.JS
# ===================================
NODE_ENV=production
NEXT_PUBLIC_API_URL=http://147.45.158.166:3002

# ===================================
# YANDEX SERVICES (–ö–†–ò–¢–ò–ß–ù–û!)
# ===================================
YANDEX_MAPS_API_KEY=–≤–∞—à_–∫–ª—é—á_–∑–¥–µ—Å—å
YANDEX_WEATHER_API_KEY=8f6b0a53-135f-4217-8de1-de98c1316cc0

# ===================================
# AI SERVICES (—Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω!)
# ===================================
GROQ_API_KEY=–≤–∞—à_–∫–ª—é—á_–∑–¥–µ—Å—å
DEEPSEEK_API_KEY=–≤–∞—à_–∫–ª—é—á_–∑–¥–µ—Å—å

# ===================================
# SECURITY (–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û!)
# ===================================
JWT_SECRET=—Å–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ_—Å–µ–∫—Ä–µ—Ç_–∑–¥–µ—Å—å
SESSION_SECRET=—Å–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ_—Å–µ–∫—Ä–µ—Ç_–∑–¥–µ—Å—å

# ===================================
# CLOUDPAYMENTS (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
# ===================================
CLOUDPAYMENTS_PUBLIC_ID=
CLOUDPAYMENTS_API_SECRET=
```

**–°–æ—Ö—Ä–∞–Ω–∏—Ç—å:** `Ctrl+O` ‚Üí Enter ‚Üí `Ctrl+X`

#### –®–ê–ì 4: –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

```bash
pm2 restart kamchatour-hub
```

#### –®–ê–ì 5: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É

```bash
# –°—Ç–∞—Ç—É—Å
pm2 status

# –õ–æ–≥–∏
pm2 logs kamchatour-hub

# –û—Ç–∫—Ä—ã—Ç—å –≤ –±—Ä–∞—É–∑–µ—Ä–µ
# http://147.45.158.166
```

**–ì–û–¢–û–í–û!** –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ –ø–æ –∞–¥—Ä–µ—Å—É: `http://147.45.158.166`

---

## üîë –ö–ê–ö –ü–û–õ–£–ß–ò–¢–¨ API –ö–õ–Æ–ß–ò (–≤—Å–µ –±–µ—Å–ø–ª–∞—Ç–Ω–æ)

### 1. Yandex Maps API (15 –º–∏–Ω—É—Ç)

```
1. –ü–µ—Ä–µ–π—Ç–∏: https://developer.tech.yandex.ru/
2. –í–æ–π—Ç–∏ —Å Yandex ID
3. –ú–æ–∏ –ø—Ä–æ–µ–∫—Ç—ã ‚Üí –°–æ–∑–¥–∞—Ç—å –ø—Ä–æ–µ–∫—Ç
4. API –∫–ª—é—á–∏ ‚Üí JavaScript API ‚Üí –°–æ–∑–¥–∞—Ç—å –∫–ª—é—á
5. –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–ª—é—á

–õ–∏–º–∏—Ç—ã: 25,000 –∑–∞–ø—Ä–æ—Å–æ–≤/–¥–µ–Ω—å (–±–µ—Å–ø–ª–∞—Ç–Ω–æ)
```

### 2. GROQ API (5 –º–∏–Ω—É—Ç)

```
1. –ü–µ—Ä–µ–π—Ç–∏: https://console.groq.com/
2. –°–æ–∑–¥–∞—Ç—å –∞–∫–∫–∞—É–Ω—Ç
3. API Keys ‚Üí Create API Key
4. –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–ª—é—á (–Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å gsk_...)

–õ–∏–º–∏—Ç—ã: 14,400 –∑–∞–ø—Ä–æ—Å–æ–≤/–¥–µ–Ω—å (–±–µ—Å–ø–ª–∞—Ç–Ω–æ)
```

### 3. DeepSeek API (5 –º–∏–Ω—É—Ç)

```
1. –ü–µ—Ä–µ–π—Ç–∏: https://platform.deepseek.com/
2. –°–æ–∑–¥–∞—Ç—å –∞–∫–∫–∞—É–Ω—Ç
3. API Keys ‚Üí Create Key
4. –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–ª—é—á (–Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å sk_...)

–ë–æ–Ω—É—Å: $5 –±–µ—Å–ø–ª–∞—Ç–Ω—ã—Ö –∫—Ä–µ–¥–∏—Ç–æ–≤
```

### 4. JWT Secret (1 –º–∏–Ω—É—Ç–∞)

**–ù–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ (–ù–ï –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ):**

```bash
# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è JWT_SECRET
openssl rand -base64 32

# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è SESSION_SECRET
openssl rand -base64 32
```

**–ò–ª–∏ –æ–Ω–ª–∞–π–Ω:**
- https://generate-secret.vercel.app/32

---

## üìù –í–ê–†–ò–ê–ù–¢ 2: –ü–æ—à–∞–≥–æ–≤—ã–π —Ä—É—á–Ω–æ–π –¥–µ–ø–ª–æ–π

### –®–ê–ì 1: –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É

```bash
ssh root@147.45.158.166
```

### –®–ê–ì 2: –û–±–Ω–æ–≤–∏—Ç—å —Å–∏—Å—Ç–µ–º—É

```bash
apt update && apt upgrade -y
```

### –®–ê–ì 3: –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Node.js 20

```bash
curl -fsSL https://deb.nodesource.com/setup_20.x | bash -
apt install -y nodejs
node -v  # –î–æ–ª–∂–Ω–æ –±—ã—Ç—å v20.x.x
```

### –®–ê–ì 4: –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å PostgreSQL

```bash
apt install -y postgresql postgresql-contrib
systemctl start postgresql
systemctl enable postgresql
```

### –®–ê–ì 5: –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö

```bash
# –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è postgres
sudo -u postgres psql

-- –í psql –≤—ã–ø–æ–ª–Ω–∏—Ç—å:
CREATE DATABASE kamchatour;
CREATE USER kamuser WITH PASSWORD '–≤–∞—à_–Ω–∞–¥–µ–∂–Ω—ã–π_–ø–∞—Ä–æ–ª—å';
GRANT ALL PRIVILEGES ON DATABASE kamchatour TO kamuser;
CREATE EXTENSION IF NOT EXISTS "uuid-ossp";
CREATE EXTENSION IF NOT EXISTS postgis;
\q
```

### –®–ê–ì 6: –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Nginx

```bash
apt install -y nginx
systemctl start nginx
systemctl enable nginx
```

### –®–ê–ì 7: –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å PM2

```bash
npm install -g pm2
```

### –®–ê–ì 8: –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–µ–∫—Ç

```bash
cd /var/www
git clone https://github.com/PosPk/kamhub.git kamchatour
cd kamchatour
```

### –®–ê–ì 9: –°–æ–∑–¥–∞—Ç—å .env —Ñ–∞–π–ª

```bash
nano .env
```

**–í—Å—Ç–∞–≤–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é** (—Å–º. –≤—ã—à–µ "–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è .env")

### –®–ê–ì 10: –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏ —Å–æ–±—Ä–∞—Ç—å

```bash
npm install
npm run build
```

### –®–ê–ì 11: –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

```bash
# –ü—Ä–∏–º–µ–Ω–∏—Ç—å —Å—Ö–µ–º—É
PGPASSWORD=–≤–∞—à_–ø–∞—Ä–æ–ª—å psql -h localhost -U kamuser -d kamchatour -f lib/database/schema.sql
PGPASSWORD=–≤–∞—à_–ø–∞—Ä–æ–ª—å psql -h localhost -U kamuser -d kamchatour -f lib/database/transfer_operator_schema.sql
PGPASSWORD=–≤–∞—à_–ø–∞—Ä–æ–ª—å psql -h localhost -U kamuser -d kamchatour -f lib/database/sos_schema.sql
```

### –®–ê–ì 12: –ó–∞–ø—É—Å—Ç–∏—Ç—å —á–µ—Ä–µ–∑ PM2

```bash
pm2 start ecosystem.config.js --env production
pm2 save
pm2 startup
```

### –®–ê–ì 13: –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Nginx

```bash
nano /etc/nginx/sites-available/kamchatour
```

**–í—Å—Ç–∞–≤–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é:**

```nginx
server {
    listen 80;
    server_name 147.45.158.166;

    # Security headers
    add_header X-Frame-Options "DENY" always;
    add_header X-Content-Type-Options "nosniff" always;
    add_header X-XSS-Protection "1; mode=block" always;

    # –õ–æ–≥–∏
    access_log /var/log/nginx/kamchatour_access.log;
    error_log /var/log/nginx/kamchatour_error.log;

    client_max_body_size 10M;

    # Proxy –∫ Next.js
    location / {
        proxy_pass http://127.0.0.1:3002;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_cache_bypass $http_upgrade;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        
        proxy_connect_timeout 60s;
        proxy_send_timeout 60s;
        proxy_read_timeout 60s;
    }

    # –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã
    location /_next/static {
        proxy_pass http://127.0.0.1:3002;
        add_header Cache-Control "public, max-age=3600, immutable";
    }
}
```

**–ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é:**

```bash
ln -s /etc/nginx/sites-available/kamchatour /etc/nginx/sites-enabled/
rm /etc/nginx/sites-enabled/default
nginx -t
systemctl reload nginx
```

### –®–ê–ì 14: –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Firewall

```bash
ufw allow 22/tcp
ufw allow 80/tcp
ufw allow 443/tcp
ufw --force enable
```

---

## ‚úÖ –ü–†–û–í–ï–†–ö–ê –ü–û–°–õ–ï –î–ï–ü–õ–û–Ø

### 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å PM2

```bash
pm2 status
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ id  ‚îÇ name             ‚îÇ status  ‚îÇ restart ‚îÇ uptime   ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ 0   ‚îÇ kamhub-production‚îÇ online  ‚îÇ 0       ‚îÇ 2m       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏

```bash
pm2 logs kamchatour-hub --lines 50
```

**–î–æ–ª–∂–Ω–æ –±—ã—Ç—å:**
```
‚úì Ready in 2.3s
‚úì Local: http://localhost:3002
```

### 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Nginx

```bash
systemctl status nginx
curl -I http://localhost
```

### 4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö

```bash
sudo -u postgres psql -d kamchatour -c "SELECT count(*) FROM users;"
```

### 5. –û—Ç–∫—Ä—ã—Ç—å –≤ –±—Ä–∞—É–∑–µ—Ä–µ

```
http://147.45.158.166
```

**–ï—Å–ª–∏ –≤–∏–¥–∏—Ç–µ –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É KamHub ‚Üí ‚úÖ –î–ï–ü–õ–û–ô –£–°–ü–ï–®–ï–ù!**

---

## üîß –ü–û–õ–ï–ó–ù–´–ï –ö–û–ú–ê–ù–î–´

### PM2

```bash
# –°—Ç–∞—Ç—É—Å –≤—Å–µ—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
pm2 status

# –õ–æ–≥–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
pm2 logs kamchatour-hub

# –õ–æ–≥–∏ —Å —Ñ–∏–ª—å—Ç—Ä–æ–º –æ—à–∏–±–æ–∫
pm2 logs kamchatour-hub --err

# –ü–æ—Å–ª–µ–¥–Ω–∏–µ 100 —Å—Ç—Ä–æ–∫ –ª–æ–≥–æ–≤
pm2 logs kamchatour-hub --lines 100

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫
pm2 restart kamchatour-hub

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞
pm2 stop kamchatour-hub

# –£–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞
pm2 delete kamchatour-hub

# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ä–µ—Å—É—Ä—Å–æ–≤
pm2 monit

# –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
pm2 save

# –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–æ—Ü–µ—Å—Å–µ
pm2 info kamchatour-hub
```

### Nginx

```bash
# –°—Ç–∞—Ç—É—Å
systemctl status nginx

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫
systemctl restart nginx

# –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (–±–µ–∑ –¥–∞—É–Ω—Ç–∞–π–º–∞)
systemctl reload nginx

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
nginx -t

# –õ–æ–≥–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
tail -f /var/log/nginx/kamchatour_access.log
tail -f /var/log/nginx/kamchatour_error.log
```

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

```bash
# –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ –ë–î
sudo -u postgres psql -d kamchatour

# –ò–ª–∏ —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º kamuser
psql -U kamuser -d kamchatour -h localhost

# –°–ø–∏—Å–æ–∫ —Ç–∞–±–ª–∏—Ü
\dt

# –í—ã—Ö–æ–¥
\q

# Backup –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
pg_dump -U kamuser -h localhost kamchatour > backup_$(date +%Y%m%d_%H%M%S).sql

# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ backup
psql -U kamuser -h localhost kamchatour < backup.sql
```

### –°–∏—Å—Ç–µ–º–Ω—ã–µ

```bash
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–∏—Å–∫–∞
df -h

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏
free -h

# –ü—Ä–æ—Ü–µ—Å—Å—ã –∏ —Ä–µ—Å—É—Ä—Å—ã
htop
# –∏–ª–∏
top

# –û—Ç–∫—Ä—ã—Ç—ã–µ –ø–æ—Ä—Ç—ã
netstat -tulpn

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ—Ä—Ç 3002
lsof -i :3002

# –õ–æ–≥–∏ —Å–∏—Å—Ç–µ–º—ã
journalctl -xe
```

---

## ‚ö†Ô∏è –†–ï–®–ï–ù–ò–ï –ü–†–û–ë–õ–ï–ú

### –ü—Ä–æ–±–ª–µ–º–∞ 1: PM2 –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç "errored"

**–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞:**
```bash
pm2 logs kamchatour-hub --lines 100
```

**–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:**

#### A. –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π DATABASE_URL

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å .env
cat /var/www/kamchatour/.env | grep DATABASE_URL

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î
psql -U kamuser -d kamchatour -h localhost
```

**–†–µ—à–µ–Ω–∏–µ:**
```bash
cd /var/www/kamchatour
nano .env
# –ò—Å–ø—Ä–∞–≤–∏—Ç—å DATABASE_URL
pm2 restart kamchatour-hub
```

#### B. –ü–æ—Ä—Ç 3002 –∑–∞–Ω—è—Ç

```bash
lsof -i :3002
```

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –£–±–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å
kill -9 <PID>
# –ò–ª–∏ –∏–∑–º–µ–Ω–∏—Ç—å –ø–æ—Ä—Ç –≤ .env –∏ ecosystem.config.js
```

#### C. –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

```bash
cd /var/www/kamchatour
npm install
npm run build
pm2 restart kamchatour-hub
```

---

### –ü—Ä–æ–±–ª–µ–º–∞ 2: Nginx –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç "502 Bad Gateway"

**–ü—Ä–∏—á–∏–Ω–∞:** Next.js –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ –∑–∞–ø—É—â–µ–Ω–æ –∏–ª–∏ –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç

**–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞:**
```bash
pm2 status
curl http://localhost:3002
```

**–†–µ—à–µ–Ω–∏–µ:**
```bash
pm2 restart kamchatour-hub
pm2 logs
```

---

### –ü—Ä–æ–±–ª–µ–º–∞ 3: –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è

**–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞:**
```bash
systemctl status postgresql
psql -U kamuser -d kamchatour -h localhost
```

**–†–µ—à–µ–Ω–∏–µ:**

#### A. PostgreSQL –Ω–µ –∑–∞–ø—É—â–µ–Ω
```bash
systemctl start postgresql
systemctl enable postgresql
```

#### B. –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–∞—Ä–æ–ª—å
```bash
sudo -u postgres psql
ALTER USER kamuser WITH PASSWORD '–Ω–æ–≤—ã–π_–ø–∞—Ä–æ–ª—å';
\q

# –û–±–Ω–æ–≤–∏—Ç—å .env
nano /var/www/kamchatour/.env
```

#### C. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
```bash
sudo -u postgres createdb kamchatour
sudo -u postgres psql -c "GRANT ALL PRIVILEGES ON DATABASE kamchatour TO kamuser;"
```

---

### –ü—Ä–æ–±–ª–µ–º–∞ 4: "Module not found" –æ—à–∏–±–∫–∏

**–†–µ—à–µ–Ω–∏–µ:**
```bash
cd /var/www/kamchatour
rm -rf node_modules .next
npm install
npm run build
pm2 restart kamchatour-hub
```

---

### –ü—Ä–æ–±–ª–µ–º–∞ 5: API –∫–ª—é—á–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç

**–ü—Ä–æ–≤–µ—Ä–∏—Ç—å:**
```bash
cat /var/www/kamchatour/.env | grep API_KEY
```

**–†–µ—à–µ–Ω–∏–µ:**
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∫–ª—é—á–∏ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω—ã –±–µ–∑ –ø—Ä–æ–±–µ–ª–æ–≤
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –∫–ª—é—á–∏ –∞–∫—Ç–∏–≤–Ω—ã
- –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ PM2 –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è .env

```bash
pm2 restart kamchatour-hub
```

---

## üìä –ú–û–ù–ò–¢–û–†–ò–ù–ì

### PM2 Monitoring

```bash
# Real-time –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
pm2 monit

# Web dashboard (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
pm2 install pm2-server-monit
```

### –õ–æ–≥–∏

```bash
# –í—Å–µ –ª–æ–≥–∏ PM2
pm2 logs

# –¢–æ–ª—å–∫–æ –æ—à–∏–±–∫–∏
pm2 logs --err

# –û—á–∏—Å—Ç–∏—Ç—å –ª–æ–≥–∏
pm2 flush
```

### –°–∏—Å—Ç–µ–º–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏

```bash
# CPU, RAM, Disk
htop

# –î–∏—Å–∫
df -h

# –ü–∞–º—è—Ç—å
free -h

# –°–µ—Ç—å
iftop
```

---

## üîÑ –û–ë–ù–û–í–õ–ï–ù–ò–ï –ü–†–û–ï–ö–¢–ê

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ß–µ—Ä–µ–∑ Git (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```bash
cd /var/www/kamchatour

# –ü–æ–ª—É—á–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
git pull origin main

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –Ω–æ–≤—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
npm install

# –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å
npm run build

# –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏ (–µ—Å–ª–∏ –µ—Å—Ç—å)
npm run migrate:up

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å
pm2 restart kamchatour-hub
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —á–µ—Ä–µ–∑ PM2

```bash
pm2 deploy production update
```

---

## üóÇÔ∏è BACKUP –°–¢–†–ê–¢–ï–ì–ò–Ø

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π backup –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (–∫–∞–∂–¥—ã–µ 6 —á–∞—Å–æ–≤)

**–°–æ–∑–¥–∞—Ç—å —Å–∫—Ä–∏–ø—Ç backup:**

```bash
nano /root/backup-kamchatour.sh
```

**–°–æ–¥–µ—Ä–∂–∏–º–æ–µ:**

```bash
#!/bin/bash
BACKUP_DIR="/root/backups"
DATE=$(date +%Y%m%d_%H%M%S)
mkdir -p $BACKUP_DIR

# Backup –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
pg_dump -U kamuser -h localhost kamchatour | gzip > $BACKUP_DIR/db_$DATE.sql.gz

# –£–¥–∞–ª–∏—Ç—å backup —Å—Ç–∞—Ä—à–µ 7 –¥–Ω–µ–π
find $BACKUP_DIR -name "db_*.sql.gz" -mtime +7 -delete

echo "Backup completed: $DATE"
```

**–°–¥–µ–ª–∞—Ç—å –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º:**

```bash
chmod +x /root/backup-kamchatour.sh
```

**–î–æ–±–∞–≤–∏—Ç—å –≤ cron:**

```bash
crontab -e
```

**–î–æ–±–∞–≤–∏—Ç—å —Å—Ç—Ä–æ–∫—É:**

```
0 */6 * * * /root/backup-kamchatour.sh >> /var/log/kamchatour-backup.log 2>&1
```

---

## üåê –ù–ê–°–¢–†–û–ô–ö–ê –î–û–ú–ï–ù–ê (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

### 1. –î–æ–±–∞–≤–∏—Ç—å A-–∑–∞–ø–∏—Å—å DNS

```
–¢–∏–ø: A
–ò–º—è: @
–ó–Ω–∞—á–µ–Ω–∏–µ: 147.45.158.166
TTL: 3600
```

### 2. –û–±–Ω–æ–≤–∏—Ç—å Nginx –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é

```bash
nano /etc/nginx/sites-available/kamchatour
```

**–ò–∑–º–µ–Ω–∏—Ç—å `server_name`:**

```nginx
server_name –≤–∞—à-–¥–æ–º–µ–Ω.ru www.–≤–∞—à-–¥–æ–º–µ–Ω.ru;
```

**–ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å Nginx:**

```bash
nginx -t
systemctl reload nginx
```

### 3. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å SSL (Let's Encrypt)

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Certbot
apt install -y certbot python3-certbot-nginx

# –ü–æ–ª—É—á–∏—Ç—å SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç
certbot --nginx -d –≤–∞—à-–¥–æ–º–µ–Ω.ru -d www.–≤–∞—à-–¥–æ–º–µ–Ω.ru

# –ê–≤—Ç–æ–ø—Ä–æ–¥–ª–µ–Ω–∏–µ (–ø—Ä–æ–≤–µ—Ä–∫–∞)
certbot renew --dry-run
```

### 4. –û–±–Ω–æ–≤–∏—Ç—å .env

```bash
nano /var/www/kamchatour/.env
```

```env
NEXT_PUBLIC_APP_URL=https://–≤–∞—à-–¥–æ–º–µ–Ω.ru
```

```bash
pm2 restart kamchatour-hub
```

---

## üí∞ –°–¢–û–ò–ú–û–°–¢–¨

```
VDS —Å–µ—Ä–≤–µ—Ä (Timeweb):              ~700‚ÇΩ/–º–µ—Å
PostgreSQL (–µ—Å–ª–∏ –≤–Ω–µ—à–Ω–∏–π):         ~500‚ÇΩ/–º–µ—Å (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
–î–æ–º–µ–Ω:                             ~300‚ÇΩ/–≥–æ–¥
SSL (Let's Encrypt):               –ë–ï–°–ü–õ–ê–¢–ù–û
AI APIs:                           –ë–ï–°–ü–õ–ê–¢–ù–û (–≤ –ª–∏–º–∏—Ç–∞—Ö)
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
–ò–¢–û–ì–û:                             ~700-1,200‚ÇΩ/–º–µ—Å
```

---

## üìÑ –ß–ï–ö–õ–ò–°–¢ –î–ï–ü–õ–û–Ø

```
‚òê 1. –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É SSH
‚òê 2. –ó–∞–ø—É—Å—Ç–∏—Ç—å deploy-timeweb.sh
‚òê 3. –ü–æ–ª—É—á–∏—Ç—å Yandex Maps API key
‚òê 4. –ü–æ–ª—É—á–∏—Ç—å GROQ API key
‚òê 5. –ü–æ–ª—É—á–∏—Ç—å DeepSeek API key
‚òê 6. –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å JWT_SECRET
‚òê 7. –ó–∞–ø–æ–ª–Ω–∏—Ç—å .env —Ñ–∞–π–ª
‚òê 8. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å PM2
‚òê 9. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É (http://147.45.158.166)
‚òê 10. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –¥–æ–º–µ–Ω (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
‚òê 11. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å SSL (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
‚òê 12. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å backup
‚òê 13. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
```

---

## üéØ –ë–´–°–¢–†–ê–Ø –ö–û–ú–ê–ù–î–ê –î–ï–ü–õ–û–Ø (ONE-LINER)

**–ï—Å–ª–∏ –≤—ã —É–≤–µ—Ä–µ–Ω—ã –∏ —Ö–æ—Ç–∏—Ç–µ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å –≤—Å—ë –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π:**

```bash
ssh root@147.45.158.166 "curl -o deploy.sh https://raw.githubusercontent.com/PosPk/kamhub/main/deploy-timeweb.sh && chmod +x deploy.sh && bash deploy.sh"
```

**–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥—ã:**
1. –ó–∞–π–¥–∏—Ç–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä: `ssh root@147.45.158.166`
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é: `cd /var/www/kamchatour`
3. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ .env: `nano .env`
4. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ: `pm2 restart kamchatour-hub`

---

## ‚úÖ –ò–¢–û–ì

**–°–µ—Ä–≤–µ—Ä –≥–æ—Ç–æ–≤ –∫ –¥–µ–ø–ª–æ—é!**

- ‚úÖ IP –¥–æ—Å—Ç—É–ø–µ–Ω (147.45.158.166)
- ‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞
- ‚úÖ –°–∫—Ä–∏–ø—Ç—ã –≥–æ—Ç–æ–≤—ã
- ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–∞

**–ú–æ–∂–Ω–æ –Ω–∞—á–∏–Ω–∞—Ç—å –¥–µ–ø–ª–æ–π!** üöÄ

---

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 26 –Ω–æ—è–±—Ä—è 2025  
**IP —Å–µ—Ä–≤–µ—Ä–∞:** 147.45.158.166  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ READY FOR PRODUCTION

üèîÔ∏è **KamHub - –°–æ–∑–¥–∞–Ω–æ –¥–ª—è –ö–∞–º—á–∞—Ç–∫–∏ —Å –ª—é–±–æ–≤—å—é!** üèîÔ∏è
