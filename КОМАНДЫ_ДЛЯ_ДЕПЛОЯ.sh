#!/bin/bash

# ๐ ะะะะะะะซ ะะะฏ ะะะะะะฏ ะคะะะะะฌะะะ ะะะะกะะ
# ะัะฟะพะปะฝะธัะต ะฝะฐ ัะตัะฒะตัะต VDS

echo "๐ ะะะะะะฎ ะคะะะะะฌะะฃะฎ ะะะะกะะฎ..."

# 1. ะะพะดะบะปััะธัััั ะบ ัะตัะฒะตัั
ssh kamchatour@5.129.248.224 << 'ENDSSH'

# 2. ะะตัะตะนัะธ ะฒ ะดะธัะตะบัะพัะธั ะฟัะพะตะบัะฐ
cd /var/www/kamchatour

# 3. ะะพะดััะฝััั ะธะทะผะตะฝะตะฝะธั ะธะท Git
echo "๐ฅ ะะพะดััะณะธะฒะฐั ะธะทะผะตะฝะตะฝะธั ะธะท Git..."
git pull origin main

# 4. ะัะพะฒะตัะธัั ััะพ ัะฐะนะปั ะพะฑะฝะพะฒะธะปะธัั
echo "๐ ะัะพะฒะตััั ัะฐะนะปั..."
ls -lh app/page.tsx
ls -lh app/final-homepage.css
ls -lh public/icons/*.svg | wc -l

# 5. ะะตัะตัะพะฑัะฐัั ะฟัะพะตะบั
echo "๐จ ะะตัะตัะพะฑะธัะฐั ะฟัะพะตะบั..."
sudo -u kamchatour NODE_ENV=production npx next build

# 6. ะะตัะตะทะฐะฟัััะธัั PM2
echo "โป๏ธ ะะตัะตะทะฐะฟััะบะฐั PM2..."
pm2 restart kamchatour

# 7. ะัะพะฒะตัะธัั ััะฐััั
echo "โ ะัะพะฒะตััั ััะฐััั..."
pm2 status kamchatour
pm2 logs kamchatour --lines 20

echo ""
echo "โ ะะะะะะ ะะะะะะจะะ!"
echo "๐ ะัะบัะพะนัะต: http://5.129.248.224"

ENDSSH
