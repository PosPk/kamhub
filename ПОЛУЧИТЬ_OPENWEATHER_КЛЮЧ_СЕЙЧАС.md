# ‚ö° –ü–û–õ–£–ß–ò–¢–¨ API –ö–õ–Æ–ß OPENWEATHER –ü–†–Ø–ú–û –°–ï–ô–ß–ê–°

## üéØ –ß–¢–û –ù–£–ñ–ù–û –°–î–ï–õ–ê–¢–¨ (2 –º–∏–Ω—É—Ç—ã)

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ë—ã—Å—Ç—Ä–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è (–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

1. **–û—Ç–∫—Ä–æ–π—Ç–µ:** https://home.openweathermap.org/users/sign_up

2. **–ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Ñ–æ—Ä–º—É:**
   ```
   Username: kamchatour_hub
   Email: –≤–∞—à_email@gmail.com  
   Password: –ü—Ä–∏–¥—É–º–∞–π—Ç–µ –ø–∞—Ä–æ–ª—å
   ```

3. **–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ email** (–ø—Ä–∏–¥–µ—Ç –ø–∏—Å—å–º–æ –≤ —Ç–µ—á–µ–Ω–∏–µ –º–∏–Ω—É—Ç—ã)

4. **–í–æ–π–¥–∏—Ç–µ:** https://home.openweathermap.org/api_keys

5. **–°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∫–ª—é—á:**
   ```
   Default: XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
   ```

6. **–ì–û–¢–û–í–û!** –ö–ª—é—á —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ä–∞–∑—É (–∏–Ω–æ–≥–¥–∞ –∞–∫—Ç–∏–≤–∞—Ü–∏—è 10-120 –º–∏–Ω—É—Ç)

---

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–µ–º–æ-–∫–ª—é—á (–¥–ª—è —Ç–µ—Å—Ç–∞)

‚ö†Ô∏è **–í—Ä–µ–º–µ–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:**

–ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—É–±–ª–∏—á–Ω—ã–π –¥–µ–º–æ-–∫–ª—é—á:
```bash
# –ù–ï –î–õ–Ø –ü–†–û–î–ê–ö–®–ï–ù–ê! –¢–æ–ª—å–∫–æ –¥–ª—è —Ç–µ—Å—Ç–∞!
OPENWEATHER_API_KEY=e80299905b9b2c6d8936cf5b8e11d36f
```

**–í–ê–ñ–ù–û:** –≠—Ç–æ—Ç –∫–ª—é—á –º–æ–∂–µ—Ç –ø–µ—Ä–µ—Å—Ç–∞—Ç—å —Ä–∞–±–æ—Ç–∞—Ç—å. –ü–æ–ª—É—á–∏—Ç–µ —Å–≤–æ–π!

---

## üöÄ –î–û–ë–ê–í–ò–¢–¨ –ö–õ–Æ–ß –ù–ê –°–ï–†–í–ï–†

### –°–ø–æ—Å–æ–± 1: –ß–µ—Ä–µ–∑ SSH

```bash
# 1. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ —Å–µ—Ä–≤–µ—Ä—É
ssh root@5.129.248.224
# –ü–∞—Ä–æ–ª—å: xQvB1pv?yZTjaR

# 2. –°–æ–∑–¥–∞–π—Ç–µ .env —Ñ–∞–π–ª (–µ—Å–ª–∏ –Ω–µ—Ç)
cd /var/www/kamhub
cat > .env << 'EOF'
NODE_ENV=production
PORT=3000
DATABASE_URL=postgresql://gen_user:q;3U+PY7XCz@Br@45.8.96.120:5432/default_db
OPENWEATHER_API_KEY=–í–ê–®_–ö–õ–Æ–ß_–ó–î–ï–°–¨
REDIS_ENABLED=false
EOF

# 3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
pm2 restart kamhub

# 4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏
pm2 logs kamhub --lines 50
```

### –°–ø–æ—Å–æ–± 2: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–∫—Ä–∏–ø—Ç

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç–µ —ç—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –∏–∑ /workspace:
./scripts/add-openweather-key.sh –í–ê–®_–ö–õ–Æ–ß_–ó–î–ï–°–¨
```

---

## ‚úÖ –ü–†–û–í–ï–†–ö–ê –†–ê–ë–û–¢–´

### 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å API –Ω–∞–ø—Ä—è–º—É—é

```bash
# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ:
curl http://localhost:3000/api/weather?city=Petropavlovsk-Kamchatsky

# –î–æ–ª–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:
{
  "temp": -4.2,
  "feels_like": -8.1,
  "condition": "clear",
  "description": "—è—Å–Ω–æ",
  "humidity": 75,
  "wind_speed": 5.2,
  "pressure": 1018,
  "icon": "01n"
}
```

### 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞ —Å–∞–π—Ç–µ

–û—Ç–∫—Ä–æ–π—Ç–µ: http://5.129.248.224/

–í—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å:
- ‚úÖ –†–µ–∞–ª—å–Ω—É—é —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—É –ü–µ—Ç—Ä–æ–ø–∞–≤–ª–æ–≤—Å–∫–∞-–ö–∞–º—á–∞—Ç—Å–∫–æ–≥–æ
- ‚úÖ –ê–∫—Ç—É–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –ø–æ–≥–æ–¥—ã
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—É—é –∞–Ω–∏–º–∞—Ü–∏—é (–∑–≤—ë–∑–¥—ã –¥–ª—è —è—Å–Ω–æ–≥–æ –Ω–µ–±–∞, —Å–Ω–µ–≥ –¥–ª—è —Å–Ω–µ–≥–∞ –∏ —Ç.–¥.)

---

## üîÑ –ï–°–õ–ò –ö–õ–Æ–ß –ù–ï –†–ê–ë–û–¢–ê–ï–¢

### –û—à–∏–±–∫–∞: "Invalid API key"

**–ü—Ä–∏—á–∏–Ω–∞:** –ö–ª—é—á –µ—â—ë –Ω–µ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω (–Ω—É–∂–Ω–æ –ø–æ–¥–æ–∂–¥–∞—Ç—å)

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü–æ–¥–æ–∂–¥–∏—Ç–µ 10-120 –º–∏–Ω—É—Ç –ø–æ—Å–ª–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
2. –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–µ–º–æ-–∫–ª—é—á –¥–ª—è —Ç–µ—Å—Ç–∞
3. –ò–ª–∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ–µ API (—Å–º. –Ω–∏–∂–µ)

### –û—à–∏–±–∫–∞: API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ç–∞—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ

**–ü—Ä–∏—á–∏–Ω–∞:** –ö—ç—à Redis

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –û—á–∏—Å—Ç–∏—Ç—å –∫—ç—à
redis-cli FLUSHALL
# –∏–ª–∏
pm2 restart kamhub
```

---

## üéÅ –ê–õ–¨–¢–ï–†–ù–ê–¢–ò–í–ù–´–ï API (–µ—Å–ª–∏ –Ω–µ —Ö–æ—á–µ—Ç—Å—è –∂–¥–∞—Ç—å)

### Open-Meteo (–ë–ï–ó —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏!)

**–ü–ª—é—Å—ã:**
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç —Å—Ä–∞–∑—É
- ‚úÖ –ë–µ–∑ –∫–ª—é—á–∞
- ‚úÖ –ë–µ—Å–ø–ª–∞—Ç–Ω–æ –Ω–∞–≤—Å–µ–≥–¥–∞
- ‚úÖ –¢–æ—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

**–ú–∏–Ω—É—Å—ã:**
- ‚ùå –ù–µ—Ç —Ä—É—Å—Å–∫–æ–≥–æ —è–∑—ã–∫–∞

**API:**
```
https://api.open-meteo.com/v1/forecast?latitude=53.0244&longitude=158.6433&current_weather=true
```

### WeatherAPI.com (–ú–≥–Ω–æ–≤–µ–Ω–Ω–∞—è –∞–∫—Ç–∏–≤–∞—Ü–∏—è!)

**–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è:** https://www.weatherapi.com/signup.aspx

**–ü–ª—é—Å—ã:**
- ‚úÖ –ö–ª—é—á —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ä–∞–∑—É!
- ‚úÖ 1,000,000 –∑–∞–ø—Ä–æ—Å–æ–≤/–º–µ—Å—è—Ü –±–µ—Å–ø–ª–∞—Ç–Ω–æ
- ‚úÖ –ï—Å—Ç—å —Ä—É—Å—Å–∫–∏–π —è–∑—ã–∫

---

## üìù –ò–¢–û–ì–û

**–ß–¢–û –°–î–ï–õ–ê–ù–û:**
1. ‚úÖ Frontend –∑–∞–≥—Ä—É–∂–∞–µ—Ç –ø–æ–≥–æ–¥—É –∏–∑ `/api/weather`
2. ‚úÖ API endpoint –≥–æ—Ç–æ–≤ (`/app/api/weather/route.ts`)
3. ‚úÖ –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ Redis (5 –º–∏–Ω—É—Ç)
4. ‚úÖ –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –∞–Ω–∏–º–∞—Ü–∏–∏ –ø–æ –ø–æ–≥–æ–¥–µ:
   - üåü –ó–≤—ë–∑–¥—ã –¥–ª—è —è—Å–Ω–æ–≥–æ –Ω–æ—á–Ω–æ–≥–æ –Ω–µ–±–∞
   - ‚ùÑÔ∏è –°–Ω–µ–≥ –¥–ª—è —Å–Ω–µ–≥–æ–ø–∞–¥–∞
   - üåßÔ∏è –î–æ–∂–¥—å –¥–ª—è –¥–æ–∂–¥—è
   - üí® –í–µ—Ç–µ—Ä –¥–ª—è –æ–±–ª–∞—á–Ω–æ/–≤–µ—Ç–µ—Ä
5. ‚úÖ –ö–æ–º–ø–∞–∫—Ç–Ω—ã–π –¥–∏–∑–∞–π–Ω
6. ‚úÖ –£–º–Ω—ã–π –ø–æ–∏—Å–∫ —Ç—É—Ä–æ–≤

**–ß–¢–û –û–°–¢–ê–õ–û–°–¨:**
1. ‚è≥ –ü–æ–ª—É—á–∏—Ç—å API –∫–ª—é—á OpenWeatherMap (2 –º–∏–Ω—É—Ç—ã)
2. ‚è≥ –î–æ–±–∞–≤–∏—Ç—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä
3. ‚è≥ –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å PM2

---

## üéØ –ë–´–°–¢–†–´–ô –°–¢–ê–†–¢

```bash
# 1. –ü–æ–ª—É—á–∏—Ç–µ –∫–ª—é—á: https://home.openweathermap.org/users/sign_up
# 2. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ —Å–µ—Ä–≤–µ—Ä—É:
sshpass -p 'xQvB1pv?yZTjaR' ssh root@5.129.248.224

# 3. –î–æ–±–∞–≤—å—Ç–µ –∫–ª—é—á:
echo "OPENWEATHER_API_KEY=–í–ê–®_–ö–õ–Æ–ß" >> /var/www/kamhub/.env

# 4. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ:
pm2 restart kamhub

# –ì–û–¢–û–í–û! üéâ
```

---

**–°—Å—ã–ª–∫–∏:**
- **–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è:** https://home.openweathermap.org/users/sign_up
- **API Keys:** https://home.openweathermap.org/api_keys
- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** https://openweathermap.org/current
- **Pricing:** https://openweathermap.org/price (Free Plan: 60 req/min, 1M req/month)
