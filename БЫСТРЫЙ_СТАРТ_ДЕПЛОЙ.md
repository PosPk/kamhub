# üöÄ –ë–´–°–¢–†–´–ô –°–¢–ê–†–¢: –î–ï–ü–õ–û–ô –ò –ü–û–î–ö–õ–Æ–ß–ï–ù–ò–ï KAMCHATOUR HUB

## üìå –û–°–ù–û–í–ù–ê–Ø –ò–ù–§–û–†–ú–ê–¶–ò–Ø

### üîó –°—Å—ã–ª–∫–∏ –Ω–∞ –ø—Ä–æ–µ–∫—Ç:
- **GitHub —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π**: https://github.com/PosPk/kamhub
- **–ü–æ–ª–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è**: https://github.com/PosPk/kamhub/blob/deploy-guide-2025/–î–ï–ü–õ–û–ô_–ò–ù–°–¢–†–£–ö–¶–ò–Ø_–ü–û–õ–ù–ê–Ø.md
- **–í–µ–±-—Å–∞–π—Ç**: https://kamchatour.ru
- **IP —Å–µ—Ä–≤–µ—Ä–∞**: 5.129.248.224

### üë§ –£—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Å–µ—Ä–≤–µ—Ä–∞:
```
–•–æ—Å—Ç: 5.129.248.224
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: root
–ü–∞—Ä–æ–ª—å: xQvB1pv?yZTjaR
SSH –ø–æ—Ä—Ç: 22
```

### üìÅ –ü—É—Ç–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:
```
–ü—Ä–æ–µ–∫—Ç: /var/www/kamhub
–õ–æ–≥–∏ PM2: /var/log/pm2/
–õ–æ–≥–∏ Nginx: /var/log/nginx/
–ë—ç–∫–∞–ø—ã: /var/backups/kamhub/
```

---

## ‚ö° –ë–´–°–¢–†–û–ï –ü–û–î–ö–õ–Æ–ß–ï–ù–ò–ï –ö –°–ï–†–í–ï–†–£

### –í–∞—Ä–∏–∞–Ω—Ç 1: SSH (Linux/Mac)

```bash
# –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–µ—Ä–≤–µ—Ä—É
ssh root@5.129.248.224

# –í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å: xQvB1pv?yZTjaR
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: SSH —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –ø–∞—Ä–æ–ª—è (Linux/Mac)

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å sshpass (–µ—Å–ª–∏ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω)
sudo apt install sshpass  # Ubuntu/Debian
brew install hudochenkov/sshpass/sshpass  # Mac

# –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –±–µ–∑ –≤–≤–æ–¥–∞ –ø–∞—Ä–æ–ª—è
sshpass -p 'xQvB1pv?yZTjaR' ssh root@5.129.248.224
```

### –í–∞—Ä–∏–∞–Ω—Ç 3: PuTTY (Windows)

1. –°–∫–∞—á–∞—Ç—å PuTTY: https://www.putty.org/
2. –ó–∞–ø—É—Å—Ç–∏—Ç—å PuTTY
3. –í –ø–æ–ª–µ "Host Name": `5.129.248.224`
4. Port: `22`
5. Connection type: `SSH`
6. –ù–∞–∂–∞—Ç—å "Open"
7. Login as: `root`
8. Password: `xQvB1pv?yZTjaR`

### –í–∞—Ä–∏–∞–Ω—Ç 4: Windows Terminal / PowerShell

```powershell
ssh root@5.129.248.224
# –í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å: xQvB1pv?yZTjaR
```

---

## üîë –ù–ê–°–¢–†–û–ô–ö–ê SSH-–ö–õ–Æ–ß–ï–ô (–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

### –î–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –±–µ–∑ –ø–∞—Ä–æ–ª—è:

**–ù–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ (Linux/Mac):**

```bash
# 1. –°–æ–∑–¥–∞—Ç—å SSH-–∫–ª—é—á (–µ—Å–ª–∏ –Ω–µ—Ç)
ssh-keygen -t rsa -b 4096 -C "–≤–∞—à_email@example.com"

# 2. –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–ª—é—á –Ω–∞ —Å–µ—Ä–≤–µ—Ä
ssh-copy-id root@5.129.248.224
# –í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å –≤ –ø–æ—Å–ª–µ–¥–Ω–∏–π —Ä–∞–∑

# 3. –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –±–µ–∑ –ø–∞—Ä–æ–ª—è
ssh root@5.129.248.224
```

**–ù–∞ Windows:**

```powershell
# 1. –°–æ–∑–¥–∞—Ç—å SSH-–∫–ª—é—á
ssh-keygen -t rsa -b 4096

# 2. –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –ø—É–±–ª–∏—á–Ω–æ–≥–æ –∫–ª—é—á–∞
type $env:USERPROFILE\.ssh\id_rsa.pub

# 3. –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ –¥–æ–±–∞–≤–∏—Ç—å –∫–ª—é—á
ssh root@5.129.248.224
mkdir -p ~/.ssh
echo "–í–°–¢–ê–í–¨–¢–ï_–°–û–î–ï–†–ñ–ò–ú–û–ï_–ü–£–ë–õ–ò–ß–ù–û–ì–û_–ö–õ–Æ–ß–ê" >> ~/.ssh/authorized_keys
chmod 600 ~/.ssh/authorized_keys
```

---

## üì• –ó–ê–ì–†–£–ó–ö–ê –§–ê–ô–õ–û–í –ù–ê –°–ï–†–í–ï–†

### –í–∞—Ä–∏–∞–Ω—Ç 1: SCP (Linux/Mac)

```bash
# –ó–∞–≥—Ä—É–∑–∏—Ç—å –æ–¥–∏–Ω —Ñ–∞–π–ª
scp /–ø—É—Ç—å/–∫/—Ñ–∞–π–ª—É root@5.129.248.224:/var/www/kamhub/

# –ó–∞–≥—Ä—É–∑–∏—Ç—å –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é
scp -r /–ø—É—Ç—å/–∫/–ø–∞–ø–∫–µ root@5.129.248.224:/var/www/kamhub/

# –°–∫–∞—á–∞—Ç—å —Ñ–∞–π–ª —Å —Å–µ—Ä–≤–µ—Ä–∞
scp root@5.129.248.224:/var/www/kamhub/package.json ~/Downloads/
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: SCP —Å –ø–∞—Ä–æ–ª–µ–º

```bash
sshpass -p 'xQvB1pv?yZTjaR' scp file.txt root@5.129.248.224:/var/www/kamhub/
```

### –í–∞—Ä–∏–∞–Ω—Ç 3: WinSCP (Windows)

1. –°–∫–∞—á–∞—Ç—å WinSCP: https://winscp.net/
2. –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ:
   - File protocol: `SFTP`
   - Host name: `5.129.248.224`
   - Port: `22`
   - User name: `root`
   - Password: `xQvB1pv?yZTjaR`
3. –ù–∞–∂–∞—Ç—å "Login"
4. –ü–µ—Ä–µ—Ç–∞—â–∏—Ç—å —Ñ–∞–π–ª—ã –≤ `/var/www/kamhub/`

### –í–∞—Ä–∏–∞–Ω—Ç 4: FileZilla (Windows/Mac/Linux)

1. –°–∫–∞—á–∞—Ç—å FileZilla: https://filezilla-project.org/
2. –§–∞–π–ª ‚Üí –ú–µ–Ω–µ–¥–∂–µ—Ä —Å–∞–π—Ç–æ–≤
3. –ù–æ–≤—ã–π —Å–∞–π—Ç:
   - –ü—Ä–æ—Ç–æ–∫–æ–ª: `SFTP`
   - –•–æ—Å—Ç: `5.129.248.224`
   - –ü–æ—Ä—Ç: `22`
   - –¢–∏–ø –≤—Ö–æ–¥–∞: `–û–±—ã—á–Ω—ã–π`
   - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: `root`
   - –ü–∞—Ä–æ–ª—å: `xQvB1pv?yZTjaR`
4. –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è

---

## üöÄ –ü–ï–†–í–ò–ß–ù–´–ô –î–ï–ü–õ–û–ô (–° –ù–£–õ–Ø)

### –®–∞–≥ 1: –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É

```bash
ssh root@5.129.248.224
```

### –®–∞–≥ 2: –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π

```bash
# –°–æ–∑–¥–∞—Ç—å –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é
mkdir -p /var/www/kamhub
cd /var/www/kamhub

# –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å –∏–∑ GitHub
git clone https://github.com/PosPk/kamhub.git .

# –ò–ª–∏ –∑–∞–≥—Ä—É–∑–∏—Ç—å —á–µ—Ä–µ–∑ SCP —Å –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω—ã
# (–Ω–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ)
# scp -r /–ø—É—Ç—å/–∫/–ø—Ä–æ–µ–∫—Ç—É/* root@5.129.248.224:/var/www/kamhub/
```

### –®–∞–≥ 3: –°–æ–∑–¥–∞—Ç—å .env —Ñ–∞–π–ª

```bash
cd /var/www/kamhub
nano .env
```

**–ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ .env:**

```env
# Database
DATABASE_URL="postgresql://kamhub_user:–í–ê–®_–ü–ê–†–û–õ–¨@localhost:5432/kamhub?schema=public"

# NextAuth
NEXTAUTH_SECRET="—Å–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ_32_—Å–∏–º–≤–æ–ª–∞"
NEXTAUTH_URL="https://kamchatour.ru"

# Telegram Bot
TELEGRAM_BOT_TOKEN="–≤–∞—à_—Ç–æ–∫–µ–Ω_–æ—Ç_BotFather"

# Environment
NODE_ENV="production"
PORT=8080
```

**–ì–µ–Ω–µ—Ä–∞—Ü–∏—è NEXTAUTH_SECRET:**

```bash
openssl rand -base64 32
```

### –®–∞–≥ 4: –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

```bash
cd /var/www/kamhub
npm install
```

### –®–∞–≥ 5: –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö

```bash
# –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏
npx prisma generate
npx prisma migrate deploy

# –ò–ª–∏ —Å–æ–∑–¥–∞—Ç—å —Ç–∞–±–ª–∏—Ü—ã
npx prisma db push
```

### –®–∞–≥ 6: –°–æ–±—Ä–∞—Ç—å –ø—Ä–æ–µ–∫—Ç

```bash
npm run build
```

### –®–∞–≥ 7: –ó–∞–ø—É—Å—Ç–∏—Ç—å —á–µ—Ä–µ–∑ PM2

```bash
# –ó–∞–ø—É—Å–∫
pm2 start npm --name kamhub -- start

# –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ –∞–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫—É
pm2 save
pm2 startup
```

### –®–∞–≥ 8: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É

```bash
# –°—Ç–∞—Ç—É—Å PM2
pm2 status

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–∞–π—Ç
curl http://localhost:8080

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Nginx
sudo systemctl status nginx
```

---

## üîÑ –û–ë–ù–û–í–õ–ï–ù–ò–ï –ü–†–û–ï–ö–¢–ê

### –°–ø–æ—Å–æ–± 1: –ß–µ—Ä–µ–∑ Git (–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```bash
# –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É
ssh root@5.129.248.224

# –ü–µ—Ä–µ–π—Ç–∏ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ø—Ä–æ–µ–∫—Ç–∞
cd /var/www/kamhub

# –ü–æ–ª—É—á–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
git pull origin main

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (–µ—Å–ª–∏ –∏–∑–º–µ–Ω–∏–ª–∏—Å—å)
npm install

# –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏ –ë–î (–µ—Å–ª–∏ –µ—Å—Ç—å)
npx prisma migrate deploy

# –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å
npm run build

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å
pm2 restart kamhub

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
pm2 status kamhub
pm2 logs kamhub --lines 20
```

### –°–ø–æ—Å–æ–± 2: –ó–∞–≥—Ä—É–∑–∫–∞ —á–µ—Ä–µ–∑ SCP

**–ù–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ:**

```bash
# –°–æ–±—Ä–∞—Ç—å –ø—Ä–æ–µ–∫—Ç –ª–æ–∫–∞–ª—å–Ω–æ
cd /–ø—É—Ç—å/–∫/–ø—Ä–æ–µ–∫—Ç—É
npm run build

# –ó–∞–≥—Ä—É–∑–∏—Ç—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä
scp -r .next package.json package-lock.json root@5.129.248.224:/var/www/kamhub/

# –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å
ssh root@5.129.248.224
cd /var/www/kamhub
npm install
pm2 restart kamhub
```

### –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

**–°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª deploy.sh –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:**

```bash
ssh root@5.129.248.224
nano /var/www/kamhub/deploy.sh
```

**–°–æ–¥–µ—Ä–∂–∏–º–æ–µ:**

```bash
#!/bin/bash
set -e
echo "üöÄ –ù–∞—á–∞–ª–æ –¥–µ–ø–ª–æ—è..."
cd /var/www/kamhub
git pull origin main
npm install
npx prisma migrate deploy
npm run build
pm2 restart kamhub
echo "‚úÖ –î–µ–ø–ª–æ–π –∑–∞–≤–µ—Ä—à—ë–Ω!"
pm2 status kamhub
```

**–°–¥–µ–ª–∞—Ç—å –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º:**

```bash
chmod +x /var/www/kamhub/deploy.sh
```

**–ó–∞–ø—É—Å–∫ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π:**

```bash
ssh root@5.129.248.224 "/var/www/kamhub/deploy.sh"
```

---

## üîç –ü–†–û–í–ï–†–ö–ê –°–¢–ê–¢–£–°–ê –ò –õ–û–ì–ò

### PM2

```bash
# –°—Ç–∞—Ç—É—Å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
pm2 status

# –õ–æ–≥–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
pm2 logs kamhub

# –ü–æ—Å–ª–µ–¥–Ω–∏–µ 50 —Å—Ç—Ä–æ–∫ –ª–æ–≥–æ–≤
pm2 logs kamhub --lines 50

# –¢–æ–ª—å–∫–æ –æ—à–∏–±–∫–∏
pm2 logs kamhub --err

# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ä–µ—Å—É—Ä—Å–æ–≤
pm2 monit

# –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–æ—Ü–µ—Å—Å–µ
pm2 info kamhub
```

### Nginx

```bash
# –°—Ç–∞—Ç—É—Å Nginx
sudo systemctl status nginx

# –õ–æ–≥–∏ –¥–æ—Å—Ç—É–ø–∞
sudo tail -f /var/log/nginx/kamhub_access.log

# –õ–æ–≥–∏ –æ—à–∏–±–æ–∫
sudo tail -f /var/log/nginx/kamhub_error.log

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
sudo nginx -t

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ Nginx
sudo systemctl restart nginx
```

### PostgreSQL

```bash
# –°—Ç–∞—Ç—É—Å –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
sudo systemctl status postgresql

# –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î
psql -U kamhub_user -d kamhub -h localhost

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∞–±–ª–∏—Ü (–≤ psql)
\dt

# –í—ã—Ö–æ–¥ –∏–∑ psql
\q
```

### –°–∏—Å—Ç–µ–º–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

```bash
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ CPU –∏ –ø–∞–º—è—Ç–∏
htop

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–∏—Å–∫–∞
df -h

# –°–≤–æ–±–æ–¥–Ω–∞—è –ø–∞–º—è—Ç—å
free -h

# –°–µ—Ç–µ–≤—ã–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
netstat -tulnp | grep :8080
netstat -tulnp | grep :80
```

---

## üÜò –ë–´–°–¢–†–û–ï –†–ï–®–ï–ù–ò–ï –ü–†–û–ë–õ–ï–ú

### –ü—Ä–æ–±–ª–µ–º–∞: –°–∞–π—Ç –Ω–µ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è (502 Bad Gateway)

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å PM2
pm2 status

# –ï—Å–ª–∏ –ø—Ä–æ—Ü–µ—Å—Å –Ω–µ –∑–∞–ø—É—â–µ–Ω
pm2 restart kamhub

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏
pm2 logs kamhub --lines 50

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å Nginx
sudo systemctl restart nginx
```

### –ü—Ä–æ–±–ª–µ–º–∞: –ò–∑–º–µ–Ω–µ–Ω–∏—è –Ω–µ –ø—Ä–∏–º–µ–Ω–∏–ª–∏—Å—å

```bash
# –û—á–∏—Å—Ç–∏—Ç—å –∫–µ—à Next.js
cd /var/www/kamhub
rm -rf .next

# –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å
npm run build

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å
pm2 restart kamhub

# –û—á–∏—Å—Ç–∏—Ç—å –∫–µ—à –±—Ä–∞—É–∑–µ—Ä–∞
# Ctrl+Shift+R –∏–ª–∏ Ctrl+F5
```

### –ü—Ä–æ–±–ª–µ–º–∞: –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å PostgreSQL
sudo systemctl status postgresql

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å PostgreSQL
sudo systemctl restart postgresql

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å .env
cat /var/www/kamhub/.env | grep DATABASE_URL

# –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
psql -U kamhub_user -d kamhub -h localhost
```

### –ü—Ä–æ–±–ª–µ–º–∞: PM2 –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è

```bash
# –£–¥–∞–ª–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å
pm2 delete kamhub

# –û—á–∏—Å—Ç–∏—Ç—å –ª–æ–≥–∏
pm2 flush

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –∑–∞–Ω–æ–≤–æ
cd /var/www/kamhub
pm2 start npm --name kamhub -- start

# –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
pm2 save
```

### –ü—Ä–æ–±–ª–µ–º–∞: –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–±–æ—Ä–∫–µ

```bash
# –û—á–∏—Å—Ç–∏—Ç—å –≤—Å—ë
cd /var/www/kamhub
rm -rf .next node_modules package-lock.json

# –ü–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å
npm install

# –°–æ–±—Ä–∞—Ç—å —Å —É–≤–µ–ª–∏—á–µ–Ω–Ω–æ–π –ø–∞–º—è—Ç—å—é
NODE_OPTIONS="--max-old-space-size=4096" npm run build
```

---

## üíæ –†–ï–ó–ï–†–í–ù–û–ï –ö–û–ü–ò–†–û–í–ê–ù–ò–ï

### –ë—ã—Å—Ç—Ä—ã–π –±—ç–∫–∞–ø –ë–î

```bash
# –°–æ–∑–¥–∞—Ç—å –¥–∞–º–ø
pg_dump -U kamhub_user -h localhost kamhub > backup_$(date +%Y%m%d).sql

# –°–æ —Å–∂–∞—Ç–∏–µ–º
pg_dump -U kamhub_user -h localhost kamhub | gzip > backup_$(date +%Y%m%d).sql.gz

# –°–∫–∞—á–∞—Ç—å –Ω–∞ –ª–æ–∫–∞–ª—å–Ω—É—é –º–∞—à–∏–Ω—É
scp root@5.129.248.224:/root/backup_*.sql.gz ~/Downloads/
```

### –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ –±—ç–∫–∞–ø–∞

```bash
# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–∑ SQL
psql -U kamhub_user -h localhost kamhub < backup_20250102.sql

# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–∑ —Å–∂–∞—Ç–æ–≥–æ
gunzip -c backup_20250102.sql.gz | psql -U kamhub_user -h localhost kamhub
```

---

## üì± –ü–û–õ–ï–ó–ù–´–ï –ö–û–ú–ê–ù–î–´

### –û–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–æ–π

```bash
# –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è, –æ–±–Ω–æ–≤–∏—Ç—å –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å
ssh root@5.129.248.224 "cd /var/www/kamhub && git pull && npm install && npm run build && pm2 restart kamhub"

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –≤—Å–µ–≥–æ
ssh root@5.129.248.224 "pm2 status && sudo systemctl status nginx && sudo systemctl status postgresql"

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏
ssh root@5.129.248.224 "pm2 logs kamhub --lines 30"

# –°–æ–∑–¥–∞—Ç—å –±—ç–∫–∞–ø –∏ —Å–∫–∞—á–∞—Ç—å
ssh root@5.129.248.224 "pg_dump -U kamhub_user -h localhost kamhub | gzip > /tmp/backup.sql.gz" && scp root@5.129.248.224:/tmp/backup.sql.gz ~/Downloads/
```

### –ê–ª–∏–∞—Å—ã –¥–ª—è .bashrc / .zshrc

```bash
# –î–æ–±–∞–≤–∏—Ç—å –≤ ~/.bashrc –∏–ª–∏ ~/.zshrc

# –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–µ—Ä–≤–µ—Ä—É
alias kamhub-ssh='ssh root@5.129.248.224'

# –î–µ–ø–ª–æ–π
alias kamhub-deploy='ssh root@5.129.248.224 "/var/www/kamhub/deploy.sh"'

# –õ–æ–≥–∏
alias kamhub-logs='ssh root@5.129.248.224 "pm2 logs kamhub"'

# –°—Ç–∞—Ç—É—Å
alias kamhub-status='ssh root@5.129.248.224 "pm2 status kamhub"'

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫
alias kamhub-restart='ssh root@5.129.248.224 "pm2 restart kamhub"'
```

**–ü–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è:**

```bash
source ~/.bashrc  # –∏–ª–∏ source ~/.zshrc
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**

```bash
kamhub-ssh       # –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É
kamhub-deploy    # –î–µ–ø–ª–æ–π –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π
kamhub-logs      # –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏
kamhub-status    # –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
kamhub-restart   # –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
```

---

## üìö –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –†–ï–°–£–†–°–´

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- **–ü–æ–ª–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –¥–µ–ø–ª–æ—é**: https://github.com/PosPk/kamhub/blob/deploy-guide-2025/–î–ï–ü–õ–û–ô_–ò–ù–°–¢–†–£–ö–¶–ò–Ø_–ü–û–õ–ù–ê–Ø.md
- Next.js: https://nextjs.org/docs
- PM2: https://pm2.keymetrics.io/docs/usage/quick-start/
- Nginx: https://nginx.org/ru/docs/
- PostgreSQL: https://www.postgresql.org/docs/

### –ö–æ–Ω—Ç–∞–∫—Ç—ã –ø—Ä–æ–µ–∫—Ç–∞

- **GitHub**: https://github.com/PosPk/kamhub
- **–°–∞–π—Ç**: https://kamchatour.ru
- **–°–µ—Ä–≤–µ—Ä**: 5.129.248.224

---

## ‚úÖ –ß–ï–ö–õ–ò–°–¢ –ü–û–°–õ–ï –î–ï–ü–õ–û–Ø

- [ ] –°–∞–π—Ç –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –ø–æ –¥–æ–º–µ–Ω—É (https://kamchatour.ru)
- [ ] PM2 –ø—Ä–æ—Ü–µ—Å—Å –∑–∞–ø—É—â–µ–Ω (`pm2 status`)
- [ ] Nginx —Ä–∞–±–æ—Ç–∞–µ—Ç (`sudo systemctl status nginx`)
- [ ] –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ–¥–∫–ª—é—á–µ–Ω–∞ (–Ω–µ—Ç –æ—à–∏–±–æ–∫ –≤ –ª–æ–≥–∞—Ö)
- [ ] SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –∞–∫—Ç–∏–≤–µ–Ω (–∑–µ–ª–µ–Ω—ã–π –∑–∞–º–æ–∫ –≤ –±—Ä–∞—É–∑–µ—Ä–µ)
- [ ] –í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç (–ø–æ–∏—Å–∫, –∏–∫–æ–Ω–∫–∏, —Ñ–∏–ª—å—Ç—Ä—ã)
- [ ] –õ–æ–≥–∏ –±–µ–∑ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫ (`pm2 logs kamhub`)
- [ ] –°–æ–∑–¥–∞–Ω –±—ç–∫–∞–ø –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

---

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è**: 2025-11-02  
**–í–µ—Ä—Å–∏—è**: 1.0  
**–°—Ç–∞—Ç—É—Å**: ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

## üéØ –ë–´–°–¢–†–´–ô –°–¢–ê–†–¢ - 3 –ö–û–ú–ê–ù–î–´

```bash
# 1. –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è
ssh root@5.129.248.224

# 2. –û–±–Ω–æ–≤–∏—Ç—å –∫–æ–¥
cd /var/www/kamhub && git pull && npm install && npm run build

# 3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å
pm2 restart kamhub && pm2 logs kamhub
```

**–ì–æ—Ç–æ–≤–æ! üöÄ**
