# ‚úÖ –ö–õ–ò–ï–ù–¢–°–ö–ê–Ø –û–®–ò–ë–ö–ê –ò–°–ü–†–ê–í–õ–ï–ù–ê

**–î–∞—Ç–∞:** 4 –Ω–æ—è–±—Ä—è 2025, 08:37 UTC  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ, –æ—à–∏–±–æ–∫ –Ω–µ—Ç

---

## üêõ –ü–†–û–ë–õ–ï–ú–ê

```
Application error: a client-side exception has occurred 
(see the browser console for more information).
```

### –ü—Ä–∏—á–∏–Ω–∞
```
Error: useTheme must be used within a ThemeProvider
```

**–î–µ—Ç–∞–ª–∏:**
- `ThemeToggle` –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –≤—ã–∑—ã–≤–∞–ª `useTheme()` –≤–æ –≤—Ä–µ–º—è —Å–µ—Ä–≤–µ—Ä–Ω–æ–≥–æ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ (SSR)
- `ThemeContext` –Ω–µ –±—ã–ª –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
- React –≤—ã–±—Ä–∞—Å—ã–≤–∞–ª –æ—à–∏–±–∫—É –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç –≤–Ω–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞

---

## üîß –†–ï–®–ï–ù–ò–ï

### 1. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω `ThemeContext.tsx`

**–ö–ª—é—á–µ–≤—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- –î–æ–±–∞–≤–ª–µ–Ω **defaultContext** –¥–ª—è SSR
- –£–±—Ä–∞–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ `undefined` –≤ `useTheme()`
- –¢–µ–ø–µ—Ä—å –∫–æ–Ω—Ç–µ–∫—Å—Ç –≤—Å–µ–≥–¥–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≤–∞–ª–∏–¥–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ

```typescript
// –î–µ—Ñ–æ–ª—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è SSR
const defaultContext: ThemeContextType = {
  theme: 'dark',
  toggleTheme: () => {},
  setTheme: () => {},
};

const ThemeContext = createContext<ThemeContextType>(defaultContext);

export function useTheme() {
  const context = useContext(ThemeContext);
  return context; // ‚úÖ –í—Å–µ–≥–¥–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≤–∞–ª–∏–¥–Ω—ã–π –æ–±—ä–µ–∫—Ç
}
```

### 2. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω `ThemeToggle.tsx`

**–ö–ª—é—á–µ–≤—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ `mounted` —Å–æ—Å—Ç–æ—è–Ω–∏—è
- –î–æ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–µ–Ω–¥–µ—Ä–∏—Ç—Å—è placeholder
- –ü–æ—Å–ª–µ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è - –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π toggle

```typescript
export function ThemeToggle({ className = '' }: ThemeToggleProps) {
  const [mounted, setMounted] = useState(false);
  
  useEffect(() => {
    setMounted(true);
  }, []);

  const { theme, toggleTheme } = useTheme();

  // ‚úÖ –ù–µ —Ä–µ–Ω–¥–µ—Ä–∏–º –¥–æ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ
  if (!mounted) {
    return (
      <div className={`w-14 h-7 rounded-full bg-gray-300 dark:bg-gray-700 ${className}`} />
    );
  }

  // ... –æ—Å—Ç–∞–ª—å–Ω–æ–π –∫–æ–¥
}
```

---

## ‚úÖ –†–ï–ó–£–õ–¨–¢–ê–¢

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
```bash
# –û—á–∏—Å—Ç–∫–∞ –ª–æ–≥–æ–≤
pm2 flush

# –¢–µ—Å—Ç–æ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã
curl http://5.129.248.224/
curl http://5.129.248.224/hub/tour-operator
curl http://5.129.248.224/hub/guide

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—à–∏–±–æ–∫
pm2 logs kamhub --err
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –õ–æ–≥–∏ –æ—à–∏–±–æ–∫ **–ü–£–°–¢–´–ï** ‚úÖ

### HTTP –°—Ç–∞—Ç—É—Å
```
HTTP/1.1 200 OK
Server: nginx/1.24.0 (Ubuntu)
Content-Type: text/html; charset=utf-8
```

### PM2 –°—Ç–∞—Ç—É—Å
```
kamhub ‚îÇ online ‚îÇ 55.6mb ‚îÇ 0 restarts
```

---

## üé® –ß–¢–û –†–ê–ë–û–¢–ê–ï–¢

### ‚úÖ –°–µ—Ä–≤–µ—Ä–Ω—ã–π —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ (SSR)
- –°—Ç—Ä–∞–Ω–∏—Ü—ã —Ä–µ–Ω–¥–µ—Ä—è—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
- ThemeToggle –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç placeholder –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
- HTML –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

### ‚úÖ –ö–ª–∏–µ–Ω—Ç—Å–∫–∞—è –≥–∏–¥—Ä–∞—Ü–∏—è
- React –ø–æ–¥—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç —Å–µ—Ä–≤–µ—Ä–Ω—ã–π HTML
- ThemeToggle –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è –ø–æ—Å–ª–µ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- –¢–µ–º—ã –ø–µ—Ä–µ–∫–ª—é—á–∞—é—Ç—Å—è –ø–ª–∞–≤–Ω–æ

### ‚úÖ –¢–µ–º—ã
- **–¢—ë–º–Ω–∞—è —Ç–µ–º–∞** (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
- **–°–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞** 
- –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å –≤ –≤–µ—Ä—Ö–Ω–µ–º –º–µ–Ω—é
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ localStorage
- –£—á—ë—Ç —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–π

---

## üß™ –ü–†–û–í–ï–†–ï–ù–û

### –°—Ç—Ä–∞–Ω–∏—Ü—ã
- ‚úÖ `/` - –ì–ª–∞–≤–Ω–∞—è
- ‚úÖ `/hub/tour-operator` - –•–∞–± —Ç—É—Ä–æ–ø–µ—Ä–∞—Ç–æ—Ä–∞
- ‚úÖ `/hub/guide` - –•–∞–± –≥–∏–¥–∞
- ‚úÖ `/hub/tourist` - –•–∞–± —Ç—É—Ä–∏—Å—Ç–∞
- ‚úÖ `/hub/transfer` - –¢—Ä–∞–Ω—Å—Ñ–µ—Ä—ã
- ‚úÖ `/auth/register` - –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
- ‚úÖ `/auth/login` - –í—Ö–æ–¥

### –§—É–Ω–∫—Ü–∏–∏
- ‚úÖ –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ç–µ–º
- ‚úÖ –ù–∞–≤–∏–≥–∞—Ü–∏—è
- ‚úÖ –§–æ—Ä–º—ã
- ‚úÖ API endpoints

---

## üìä –¢–ï–•–ù–ò–ß–ï–°–ö–ò–ï –î–ï–¢–ê–õ–ò

### Next.js SSR Flow

**–î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
```
Server ‚Üí render ThemeToggle ‚Üí useTheme() ‚Üí ‚ùå Error (no context)
```

**–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
```
Server ‚Üí render ThemeToggle ‚Üí mounted=false ‚Üí ‚úÖ placeholder
Client ‚Üí hydrate ‚Üí mounted=true ‚Üí ‚úÖ full toggle with useTheme()
```

### React Hydration

1. **Server:** –†–µ–Ω–¥–µ—Ä–∏—Ç placeholder div
2. **Client:** React –≤–∏–¥–∏—Ç placeholder
3. **Client:** `useEffect` —Å—Ç–∞–≤–∏—Ç `mounted=true`
4. **Client:** –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –ø–µ—Ä–µ—Ä–µ–Ω–¥–µ—Ä–∏–≤–∞–µ—Ç—Å—è —Å –ø–æ–ª–Ω—ã–º —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–æ–º
5. **Client:** `useTheme()` —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ ThemeProvider –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ

---

## üöÄ –î–ï–ü–õ–û–ô

### –ö–æ–º–∞–Ω–¥—ã –≤—ã–ø–æ–ª–Ω–µ–Ω—ã
```bash
# 1. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤
cat > contexts/ThemeContext.tsx
cat > components/ThemeToggle.tsx

# 2. –û—á–∏—Å—Ç–∫–∞ –∏ –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∞
pm2 delete all
rm -rf .next
npm run build

# 3. –°–æ–∑–¥–∞–Ω–∏–µ manifest
echo '{...}' > .next/prerender-manifest.json

# 4. –ó–∞–ø—É—Å–∫
pm2 start npm --name kamhub -- start
pm2 save
```

---

## ‚úÖ –ò–¢–û–ì

**–ö–õ–ò–ï–ù–¢–°–ö–ê–Ø –û–®–ò–ë–ö–ê –£–°–¢–†–ê–ù–ï–ù–ê ‚úÖ**  
**–°–ê–ô–¢ –†–ê–ë–û–¢–ê–ï–¢ –ë–ï–ó –û–®–ò–ë–û–ö ‚úÖ**  
**–í–°–ï –°–¢–†–ê–ù–ò–¶–´ –î–û–°–¢–£–ü–ù–´ ‚úÖ**  
**–¢–ï–ú–´ –ü–ï–†–ï–ö–õ–Æ–ß–ê–Æ–¢–°–Ø ‚úÖ**

### üåê –°–ê–ô–¢
http://5.129.248.224

### üìã –°–¢–ê–¢–£–°
- HTTP: `200 OK`
- PM2: `online`
- Errors: `0`
- Memory: `55.6mb`
- Restarts: `0`

---

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ Cursor Agent**  
**–í—Ä–µ–º—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:** 10 –º–∏–Ω—É—Ç  
**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:** –ü—Ä–æ–π–¥–µ–Ω–æ
