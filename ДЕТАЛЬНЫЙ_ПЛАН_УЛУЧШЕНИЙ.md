# üìã –î–ï–¢–ê–õ–¨–ù–´–ô –ü–õ–ê–ù –£–õ–£–ß–®–ï–ù–ò–ô KAMCHATOUR HUB

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** –î–µ–∫–∞–±—Ä—å 2024  
**–°—Ä–æ–∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:** 6-8 –Ω–µ–¥–µ–ª—å  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –ö—Ä–∏—Ç–∏—á–Ω—ã–µ ‚Üí –í–∞–∂–Ω—ã–µ ‚Üí –ñ–µ–ª–∞—Ç–µ–ª—å–Ω—ã–µ

---

## üéØ –û–ë–©–ê–Ø –°–¢–†–ê–¢–ï–ì–ò–Ø

### –¶–µ–ª–∏ –ø–ª–∞–Ω–∞:
1. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** - –ü—Ä–∏–º–µ–Ω–∏—Ç—å –∑–∞—â–∏—Ç–Ω—ã–µ –º–µ—Ö–∞–Ω–∏–∑–º—ã –≤–µ–∑–¥–µ
2. **UX/UI** - –£–ª—É—á—à–∏—Ç—å –Ω–∞–≤–∏–≥–∞—Ü–∏—é –∏ —É–¥–æ–±—Å—Ç–≤–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
3. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** - –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã –∏ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ
4. **–ö–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞** - –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –∏ —É–ª—É—á—à–µ–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã
5. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** - –£–≤–µ–ª–∏—á–∏—Ç—å –ø–æ–∫—Ä—ã—Ç–∏–µ –¥–æ 80%+

---

## üìÖ –§–ê–ó–ê 1: –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨ –ò –û–°–ù–û–í–ê (–ù–µ–¥–µ–ª—è 1-2)

### üî¥ –ö–†–ò–¢–ò–ß–ù–û - –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1

#### 1.1 –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ CSRF –∑–∞—â–∏—Ç—ã (2 –¥–Ω—è)

**–ó–∞–¥–∞—á–∞:** –û–±–µ—Ä–Ω—É—Ç—å –≤—Å–µ state-changing API routes –≤ `withCsrfProtection`

**–§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
```
app/api/
‚îú‚îÄ‚îÄ transfers/book/route.ts          ‚Üê POST (–∫—Ä–∏—Ç–∏—á–Ω–æ)
‚îú‚îÄ‚îÄ transfers/confirm/route.ts       ‚Üê POST
‚îú‚îÄ‚îÄ transfers/payment/confirm/route.ts ‚Üê POST
‚îú‚îÄ‚îÄ tours/route.ts                    ‚Üê POST, PUT, DELETE
‚îú‚îÄ‚îÄ partners/route.ts                 ‚Üê POST, PUT, DELETE
‚îú‚îÄ‚îÄ auth/signin/route.ts              ‚Üê POST
‚îú‚îÄ‚îÄ auth/signup/route.ts              ‚Üê POST
‚îú‚îÄ‚îÄ loyalty/promo/apply/route.ts      ‚Üê POST
‚îú‚îÄ‚îÄ eco-points/route.ts               ‚Üê POST
‚îî‚îÄ‚îÄ eco-points/user/route.ts          ‚Üê POST
```

**–®–∞–≥–∏:**
1. ‚úÖ –°–æ–∑–¥–∞—Ç—å wrapper –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–ª—è –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–π —Å—Ç–æ—Ä–æ–Ω—ã
2. ‚úÖ –û–±–Ω–æ–≤–∏—Ç—å –∫–∞–∂–¥—ã–π route (10 —Ñ–∞–π–ª–æ–≤)
3. ‚úÖ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ –≤—Å–µ—Ö —Ñ–æ—Ä–º–∞—Ö
4. ‚úÖ –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ —Ç–æ–∫–µ–Ω—ã –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è

**–û—Ü–µ–Ω–∫–∞ –≤—Ä–µ–º–µ–Ω–∏:** 6-8 —á–∞—Å–æ–≤  
**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** –°—Ä–µ–¥–Ω—è—è  
**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** –ù–µ—Ç

---

#### 1.2 –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ Rate Limiting (1 –¥–µ–Ω—å)

**–ó–∞–¥–∞—á–∞:** –ü—Ä–∏–º–µ–Ω–∏—Ç—å rate limiting –∫–æ –≤—Å–µ–º API routes

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã–µ endpoints:**
```
–ö—Ä–∏—Ç–∏—á–Ω—ã–µ (—Å—Ç—Ä–æ–≥–∏–π –ª–∏–º–∏—Ç):
‚îú‚îÄ‚îÄ /api/auth/*          ‚Üí 5 –∑–∞–ø—Ä–æ—Å–æ–≤/15 –º–∏–Ω
‚îú‚îÄ‚îÄ /api/transfers/book ‚Üí 5 –∑–∞–ø—Ä–æ—Å–æ–≤/1 –º–∏–Ω
‚îî‚îÄ‚îÄ /api/tours (POST)    ‚Üí 5 –∑–∞–ø—Ä–æ—Å–æ–≤/1 –º–∏–Ω

–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ (API –ª–∏–º–∏—Ç):
‚îú‚îÄ‚îÄ /api/tours (GET)     ‚Üí 100 –∑–∞–ø—Ä–æ—Å–æ–≤/15 –º–∏–Ω
‚îú‚îÄ‚îÄ /api/transfers/*     ‚Üí 100 –∑–∞–ø—Ä–æ—Å–æ–≤/15 –º–∏–Ω
‚îî‚îÄ‚îÄ /api/partners/*      ‚Üí 100 –∑–∞–ø—Ä–æ—Å–æ–≤/15 –º–∏–Ω

–ü—É–±–ª–∏—á–Ω—ã–µ (–º—è–≥–∫–∏–π –ª–∏–º–∏—Ç):
‚îú‚îÄ‚îÄ /api/weather         ‚Üí 30 –∑–∞–ø—Ä–æ—Å–æ–≤/1 –º–∏–Ω
‚îî‚îÄ‚îÄ /api/eco-points      ‚Üí 30 –∑–∞–ø—Ä–æ—Å–æ–≤/1 –º–∏–Ω
```

**–®–∞–≥–∏:**
1. ‚úÖ –ü—Ä–∏–º–µ–Ω–∏—Ç—å `withRateLimit` –∫ –∫–∞–∂–¥–æ–º—É route
2. ‚úÖ –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Ä–∞–∑–Ω—ã–µ –ø—Ä–µ—Å–µ—Ç—ã –¥–ª—è —Ä–∞–∑–Ω—ã—Ö endpoints
3. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å rate limit headers –≤ –æ—Ç–≤–µ—Ç—ã
4. ‚úÖ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–µ–≤—ã—à–µ–Ω–∏–µ –ª–∏–º–∏—Ç–æ–≤

**–û—Ü–µ–Ω–∫–∞ –≤—Ä–µ–º–µ–Ω–∏:** 4-5 —á–∞—Å–æ–≤  
**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** –ù–∏–∑–∫–∞—è  
**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** –ù–µ—Ç

---

#### 1.3 –†–µ–∞–ª–∏–∑–∞—Ü–∏—è JWT –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ (2 –¥–Ω—è)

**–ó–∞–¥–∞—á–∞:** –ó–∞–º–µ–Ω–∏—Ç—å hardcoded userId –Ω–∞ —Ä–µ–∞–ª—å–Ω—É—é JWT –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é

**–¢–µ–∫—É—â–∞—è –ø—Ä–æ–±–ª–µ–º–∞:**
```typescript
// ‚ùå app/api/transfers/book/route.ts:104
userId: 'user_123', // TODO: –ø–æ–ª—É—á–∞—Ç—å –∏–∑ JWT —Ç–æ–∫–µ–Ω–∞
```

**–ù—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å:**
```
lib/auth/
‚îú‚îÄ‚îÄ jwt.ts              ‚Üí –ì–µ–Ω–µ—Ä–∞—Ü–∏—è/–≤–∞–ª–∏–¥–∞—Ü–∏—è —Ç–æ–∫–µ–Ω–æ–≤
‚îú‚îÄ‚îÄ middleware.ts       ‚Üí withAuth wrapper
‚îî‚îÄ‚îÄ utils.ts            ‚Üí –•–µ–ª–ø–µ—Ä—ã
```

**–®–∞–≥–∏:**
1. ‚úÖ –°–æ–∑–¥–∞—Ç—å `lib/auth/jwt.ts` —Å —Ñ—É–Ω–∫—Ü–∏—è–º–∏:
   - `generateToken(userId, role)`
   - `verifyToken(token)`
   - `refreshToken(refreshToken)`

2. ‚úÖ –°–æ–∑–¥–∞—Ç—å `lib/auth/middleware.ts`:
   ```typescript
   export function withAuth(handler: Function) {
     return async (request: NextRequest) => {
       const token = extractToken(request);
       const payload = await verifyToken(token);
       return handler(request, payload);
     };
   }
   ```

3. ‚úÖ –û–±–Ω–æ–≤–∏—Ç—å API routes (10+ —Ñ–∞–π–ª–æ–≤):
   - `/api/transfers/book`
   - `/api/tours` (POST, PUT, DELETE)
   - `/api/operator/*`
   - `/api/loyalty/*`
   - –∏ –¥—Ä—É–≥–∏–µ

4. ‚úÖ –û–±–Ω–æ–≤–∏—Ç—å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥:
   - –°–æ—Ö—Ä–∞–Ω—è—Ç—å —Ç–æ–∫–µ–Ω –≤ localStorage/cookie
   - –î–æ–±–∞–≤–ª—è—Ç—å –≤ Authorization header
   - –û–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å 401 –æ—à–∏–±–∫–∏

5. ‚úÖ –û–±–Ω–æ–≤–∏—Ç—å auth routes:
   - `/api/auth/signin` ‚Üí –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å JWT
   - `/api/auth/signup` ‚Üí –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å JWT

**–û—Ü–µ–Ω–∫–∞ –≤—Ä–µ–º–µ–Ω–∏:** 12-16 —á–∞—Å–æ–≤  
**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** –í—ã—Å–æ–∫–∞—è  
**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** –ù–µ—Ç (–º–æ–∂–Ω–æ –¥–µ–ª–∞—Ç—å –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ —Å 1.1, 1.2)

---

#### 1.4 –£–±—Ä–∞—Ç—å console.log –∏–∑ production (1 –¥–µ–Ω—å)

**–ó–∞–¥–∞—á–∞:** –°–æ–∑–¥–∞—Ç—å logger –∏ –∑–∞–º–µ–Ω–∏—Ç—å –≤—Å–µ console.log

**–ù–∞–π–¥–µ–Ω–æ:** 58+ console.log/error –≤ –∫–æ–¥–µ

**–°–æ–∑–¥–∞—Ç—å:**
```
lib/
‚îî‚îÄ‚îÄ logger.ts ‚Üí –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å —É—Ä–æ–≤–Ω—è–º–∏
```

**–®–∞–≥–∏:**
1. ‚úÖ –°–æ–∑–¥–∞—Ç—å `lib/logger.ts`:
   ```typescript
   export const logger = {
     debug: (msg, context) => { /* —Ç–æ–ª—å–∫–æ –≤ dev */ },
     info: (msg, context) => { /* –≤–µ–∑–¥–µ */ },
     warn: (msg, context) => { /* –≤–µ–∑–¥–µ */ },
     error: (msg, error) => { /* –≤–µ–∑–¥–µ + Sentry */ },
   };
   ```

2. ‚úÖ –ù–∞–π—Ç–∏ –∏ –∑–∞–º–µ–Ω–∏—Ç—å –≤—Å–µ console.*:
   ```bash
   grep -r "console\." app/ lib/
   ```

3. ‚úÖ –ó–∞–º–µ–Ω–∏—Ç—å –ø–æ —Ñ–∞–π–ª–∞–º:
   - `app/api/**/*.ts` (24 —Ñ–∞–π–ª–∞)
   - `lib/**/*.ts` (10 —Ñ–∞–π–ª–æ–≤)
   - `components/**/*.tsx` (5 —Ñ–∞–π–ª–æ–≤)

4. ‚úÖ –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –æ—Ç–ø—Ä–∞–≤–∫—É –æ—à–∏–±–æ–∫ –≤ Sentry (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

**–û—Ü–µ–Ω–∫–∞ –≤—Ä–µ–º–µ–Ω–∏:** 4-6 —á–∞—Å–æ–≤  
**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** –ù–∏–∑–∫–∞—è (–Ω–æ –º–Ω–æ–≥–æ —Ñ–∞–π–ª–æ–≤)  
**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** –ù–µ—Ç

---

### üìä –ò—Ç–æ–≥–∏ –§–∞–∑—ã 1:
- **–í—Ä–µ–º—è:** 4-5 –¥–Ω–µ–π
- **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ü—Ä–æ–µ–∫—Ç –∑–∞—â–∏—â–µ–Ω, –∫–æ–¥ —á–∏—Å—Ç—ã–π
- **–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É:** 60% ‚Üí 75%

---

## üé® –§–ê–ó–ê 2: –î–ò–ó–ê–ô–ù –ò –ù–ê–í–ò–ì–ê–¶–ò–Ø (–ù–µ–¥–µ–ª—è 2-3)

### üü° –í–ê–ñ–ù–û - –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2

#### 2.1 –°–æ–∑–¥–∞–Ω–∏–µ AppLayout —Å Sidebar (2 –¥–Ω—è)

**–ó–∞–¥–∞—á–∞:** –°–æ–∑–¥–∞—Ç—å –µ–¥–∏–Ω—É—é —Å–∏—Å—Ç–µ–º—É –Ω–∞–≤–∏–≥–∞—Ü–∏–∏

**–ù–æ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**
```
components/Layout/
‚îú‚îÄ‚îÄ AppLayout.tsx       ‚Üí –û—Å–Ω–æ–≤–Ω–æ–π layout wrapper
‚îú‚îÄ‚îÄ Sidebar.tsx         ‚Üí –ë–æ–∫–æ–≤–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è
‚îú‚îÄ‚îÄ Header.tsx          ‚Üí –í–µ—Ä—Ö–Ω—è—è –ø–∞–Ω–µ–ª—å
‚îú‚îÄ‚îÄ MobileNav.tsx       ‚Üí –ú–æ–±–∏–ª—å–Ω–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è (bottom)
‚îî‚îÄ‚îÄ Breadcrumbs.tsx    ‚Üí –•–ª–µ–±–Ω—ã–µ –∫—Ä–æ—à–∫–∏
```

**–®–∞–≥–∏:**

**–î–µ–Ω—å 1:**
1. ‚úÖ –°–æ–∑–¥–∞—Ç—å `components/Layout/Sidebar.tsx`
   - –ò–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è
   - –ê–∫—Ç–∏–≤–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
   - Collapsible –ø–æ–¥–º–µ–Ω—é
   - –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å (—Å–∫—Ä—ã–≤–∞–µ—Ç—Å—è –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö)

2. ‚úÖ –°–æ–∑–¥–∞—Ç—å `components/Layout/Header.tsx`
   - –õ–æ–≥–æ—Ç–∏–ø
   - –ì–ª–æ–±–∞–ª—å–Ω—ã–π –ø–æ–∏—Å–∫
   - –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
   - –ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

3. ‚úÖ –°–æ–∑–¥–∞—Ç—å `components/Layout/MobileNav.tsx`
   - Bottom navigation –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö
   - 5 –æ—Å–Ω–æ–≤–Ω—ã—Ö –ø—É–Ω–∫—Ç–æ–≤
   - –ê–∫—Ç–∏–≤–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è

**–î–µ–Ω—å 2:**
4. ‚úÖ –°–æ–∑–¥–∞—Ç—å `components/Layout/AppLayout.tsx`
   ```typescript
   export function AppLayout({ children, role }) {
     return (
       <div className="flex">
         <Sidebar role={role} />
         <main className="flex-1 ml-64">
           <Header />
           {children}
         </main>
       </div>
     );
   }
   ```

5. ‚úÖ –û–±–Ω–æ–≤–∏—Ç—å –≤—Å–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã:
   - `app/hub/tourist/page.tsx`
   - `app/hub/operator/page.tsx`
   - `app/hub/transfer/page.tsx`
   - –∏ –¥—Ä—É–≥–∏–µ (11 —Å—Ç—Ä–∞–Ω–∏—Ü)

6. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å media queries –¥–ª—è –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç–∏

**–û—Ü–µ–Ω–∫–∞ –≤—Ä–µ–º–µ–Ω–∏:** 12-16 —á–∞—Å–æ–≤  
**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** –°—Ä–µ–¥–Ω—è—è  
**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** –ù–µ—Ç (–º–æ–∂–Ω–æ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ —Å –§–∞–∑–æ–π 1)

---

#### 2.2 –£–ø—Ä–æ—â–µ–Ω–∏–µ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã (1 –¥–µ–Ω—å)

**–ó–∞–¥–∞—á–∞:** –£–±—Ä–∞—Ç—å —Ç–∞–±—ã, —Å–æ–∑–¥–∞—Ç—å focused –≥–ª–∞–≤–Ω—É—é

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
```
app/page.tsx (–≥–ª–∞–≤–Ω–∞—è)
‚îú‚îÄ‚îÄ Hero Section —Å —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–º –ø–æ–∏—Å–∫–æ–º
‚îú‚îÄ‚îÄ Quick Actions (4 –∫–∞—Ä—Ç–æ—á–∫–∏)
‚îî‚îÄ‚îÄ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
```

**–®–∞–≥–∏:**
1. ‚úÖ –£–±—Ä–∞—Ç—å —Ç–∞–±—ã —Å –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã
2. ‚úÖ –°–æ–∑–¥–∞—Ç—å Hero section:
   - –ó–∞–≥–æ–ª–æ–≤–æ–∫ + –æ–ø–∏—Å–∞–Ω–∏–µ
   - –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –ø–æ–∏—Å–∫ (—Ç—É—Ä—ã + —Ç—Ä–∞–Ω—Å—Ñ–µ—Ä—ã)
   - CTA –∫–Ω–æ–ø–∫–∏

3. ‚úÖ –°–æ–∑–¥–∞—Ç—å `components/Dashboard/QuickActions.tsx`
   - 4 –∫–∞—Ä—Ç–æ—á–∫–∏: –ü–æ–ø—É–ª—è—Ä–Ω—ã–µ —Ç—É—Ä—ã, –¢—Ä–∞–Ω—Å—Ñ–µ—Ä—ã, –ü–æ–≥–æ–¥–∞, AI

4. ‚úÖ –ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ —Ñ—É–Ω–∫—Ü–∏–∏ –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã:
   - –¢—É—Ä—ã ‚Üí `/tours`
   - –¢—Ä–∞–Ω—Å—Ñ–µ—Ä—ã ‚Üí `/transfers`
   - –ü–æ–≥–æ–¥–∞ ‚Üí `/weather`
   - AI ‚Üí `/ai-chat`

5. ‚úÖ –û–±–Ω–æ–≤–∏—Ç—å routing –≤ Next.js

**–û—Ü–µ–Ω–∫–∞ –≤—Ä–µ–º–µ–Ω–∏:** 6-8 —á–∞—Å–æ–≤  
**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** –°—Ä–µ–¥–Ω—è—è  
**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** –ó–∞–≤–∏—Å–∏—Ç –æ—Ç 2.1 (–Ω—É–∂–µ–Ω AppLayout)

---

#### 2.3 –°–æ–∑–¥–∞–Ω–∏–µ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Å—Ç—Ä–∞–Ω–∏—Ü –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–π (1 –¥–µ–Ω—å)

**–ó–∞–¥–∞—á–∞:** –í—ã–Ω–µ—Å—Ç–∏ —Ñ—É–Ω–∫—Ü–∏–∏ –∏–∑ —Ç–∞–±–æ–≤ –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã

**–ù–æ–≤—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã:**
```
app/
‚îú‚îÄ‚îÄ tours/
‚îÇ   ‚îú‚îÄ‚îÄ page.tsx              ‚Üí –ö–∞—Ç–∞–ª–æ–≥ —Ç—É—Ä–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ [id]/page.tsx         ‚Üí –î–µ—Ç–∞–ª–∏ —Ç—É—Ä–∞
‚îÇ   ‚îî‚îÄ‚îÄ book/page.tsx         ‚Üí –ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
‚îú‚îÄ‚îÄ transfers/
‚îÇ   ‚îú‚îÄ‚îÄ page.tsx              ‚Üí –ü–æ–∏—Å–∫ —Ç—Ä–∞–Ω—Å—Ñ–µ—Ä–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ [id]/page.tsx         ‚Üí –î–µ—Ç–∞–ª–∏ —Ç—Ä–∞–Ω—Å—Ñ–µ—Ä–∞
‚îÇ   ‚îî‚îÄ‚îÄ book/page.tsx        ‚Üí –ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
‚îú‚îÄ‚îÄ weather/
‚îÇ   ‚îî‚îÄ‚îÄ page.tsx              ‚Üí –î–µ—Ç–∞–ª—å–Ω—ã–π –ø—Ä–æ–≥–Ω–æ–∑
‚îî‚îÄ‚îÄ ai-chat/
    ‚îî‚îÄ‚îÄ page.tsx              ‚Üí AI-–ø–æ–º–æ—â–Ω–∏–∫
```

**–®–∞–≥–∏:**
1. ‚úÖ –°–æ–∑–¥–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π
2. ‚úÖ –ú–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –∫–æ–Ω—Ç–µ–Ω—Ç –∏–∑ —Ç–∞–±–æ–≤ –≤ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
3. ‚úÖ –û–±–Ω–æ–≤–∏—Ç—å —Å—Å—ã–ª–∫–∏ –≤ Sidebar
4. ‚úÖ –û–±–Ω–æ–≤–∏—Ç—å —Ä–æ—É—Ç–∏–Ω–≥

**–û—Ü–µ–Ω–∫–∞ –≤—Ä–µ–º–µ–Ω–∏:** 6-8 —á–∞—Å–æ–≤  
**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** –ù–∏–∑–∫–∞—è-–°—Ä–µ–¥–Ω—è—è  
**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** –ó–∞–≤–∏—Å–∏—Ç –æ—Ç 2.1, 2.2

---

#### 2.4 Slide-over –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–ª—è inline –¥–µ–π—Å—Ç–≤–∏–π (1 –¥–µ–Ω—å)

**–ó–∞–¥–∞—á–∞:** –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ –±–µ–∑ –ø–µ—Ä–µ—Ö–æ–¥–∞ –Ω–∞ –¥—Ä—É–≥—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É

**–°–æ–∑–¥–∞—Ç—å:**
```
components/UI/
‚îú‚îÄ‚îÄ SlideOver.tsx      ‚Üí –ü–∞–Ω–µ–ª—å —Å–ø—Ä–∞–≤–∞
‚îú‚îÄ‚îÄ Modal.tsx          ‚Üí –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–µ –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
‚îî‚îÄ‚îÄ useModal.ts        ‚Üí Hook –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
```

**–®–∞–≥–∏:**
1. ‚úÖ –°–æ–∑–¥–∞—Ç—å `components/UI/SlideOver.tsx`
   - –ê–Ω–∏–º–∞—Ü–∏—è slide-in —Å–ø—Ä–∞–≤–∞
   - Backdrop —Å blur
   - Escape –¥–ª—è –∑–∞–∫—Ä—ã—Ç–∏—è
   - Portal –¥–ª—è —Ä–µ–Ω–¥–µ—Ä–∞

2. ‚úÖ –°–æ–∑–¥–∞—Ç—å `components/UI/Modal.tsx`
   - –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
   - –ê–Ω–∏–º–∞—Ü–∏–∏ fade-in

3. ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤:
   - –ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç—É—Ä–æ–≤
   - –ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç—Ä–∞–Ω—Å—Ñ–µ—Ä–æ–≤
   - –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç—É—Ä–æ–≤ (–æ–ø–µ—Ä–∞—Ç–æ—Ä)

**–û—Ü–µ–Ω–∫–∞ –≤—Ä–µ–º–µ–Ω–∏:** 6-8 —á–∞—Å–æ–≤  
**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** –°—Ä–µ–¥–Ω—è—è  
**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** –ù–µ—Ç

---

### üìä –ò—Ç–æ–≥–∏ –§–∞–∑—ã 2:
- **–í—Ä–µ–º—è:** 4-5 –¥–Ω–µ–π
- **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –£–¥–æ–±–Ω–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è, —É–ª—É—á—à–µ–Ω–Ω—ã–π UX
- **–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É:** 75% ‚Üí 85%

---

## ‚ö° –§–ê–ó–ê 3: –ü–†–û–ò–ó–í–û–î–ò–¢–ï–õ–¨–ù–û–°–¢–¨ (–ù–µ–¥–µ–ª—è 3-4)

### üü° –í–ê–ñ–ù–û - –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2

#### 3.1 –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ N+1 –∑–∞–ø—Ä–æ—Å–æ–≤ (1 –¥–µ–Ω—å)

**–ü—Ä–æ–±–ª–µ–º–∞:** –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –≤–º–µ—Å—Ç–æ JOIN

**–§–∞–π–ª—ã –¥–ª—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
```
app/api/transfers/search/route.ts
‚îú‚îÄ‚îÄ ‚ùå –î–≤–∞ –∑–∞–ø—Ä–æ—Å–∞: routeQuery + scheduleQuery
‚îî‚îÄ‚îÄ ‚úÖ –û–¥–∏–Ω JOIN –∑–∞–ø—Ä–æ—Å
```

**–®–∞–≥–∏:**
1. ‚úÖ –ù–∞–π—Ç–∏ –≤—Å–µ N+1 –ø—Ä–æ–±–ª–µ–º—ã:
   ```bash
   # –ü–æ–∏—Å–∫ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö query –≤—ã–∑–æ–≤–æ–≤
   grep -A 5 "await query" app/api/**/*.ts
   ```

2. ‚úÖ –ò—Å–ø—Ä–∞–≤–∏—Ç—å `/api/transfers/search`:
   ```sql
   -- –í–º–µ—Å—Ç–æ –¥–≤—É—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
   SELECT s.*, r.*, v.*, d.*, o.*
   FROM transfer_schedules s
   JOIN transfer_routes r ON s.route_id = r.id
   JOIN transfer_vehicles v ON s.vehicle_id = v.id
   JOIN transfer_drivers d ON s.driver_id = d.id
   JOIN operators o ON v.operator_id = o.id
   WHERE ...
   ```

3. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥—Ä—É–≥–∏–µ endpoints:
   - `/api/tours`
   - `/api/partners`
   - `/api/operator/dashboard`

4. ‚úÖ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (–¥–æ/–ø–æ—Å–ª–µ)

**–û—Ü–µ–Ω–∫–∞ –≤—Ä–µ–º–µ–Ω–∏:** 6-8 —á–∞—Å–æ–≤  
**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** –°—Ä–µ–¥–Ω—è—è  
**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** –ù–µ—Ç

---

#### 3.2 –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è (2 –¥–Ω—è)

**–ó–∞–¥–∞—á–∞:** Redis –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö

**–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è:**
```
–ö—ç—à–∏—Ä–æ–≤–∞—Ç—å (TTL):
‚îú‚îÄ‚îÄ /api/tours (GET)          ‚Üí 5 –º–∏–Ω—É—Ç
‚îú‚îÄ‚îÄ /api/partners (GET)       ‚Üí 10 –º–∏–Ω—É—Ç
‚îú‚îÄ‚îÄ /api/weather              ‚Üí 30 –º–∏–Ω—É—Ç (—É–∂–µ –µ—Å—Ç—å, —É–ª—É—á—à–∏—Ç—å)
‚îú‚îÄ‚îÄ /api/transfers/search     ‚Üí 2 –º–∏–Ω—É—Ç—ã
‚îî‚îÄ‚îÄ /api/operator/stats       ‚Üí 1 –º–∏–Ω—É—Ç–∞
```

**–®–∞–≥–∏:**

**–î–µ–Ω—å 1:**
1. ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Redis (–∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å in-memory –¥–ª—è dev)
2. ‚úÖ –°–æ–∑–¥–∞—Ç—å `lib/cache/redis.ts`:
   ```typescript
   export const cache = {
     get: async (key) => { /* ... */ },
     set: async (key, value, ttl) => { /* ... */ },
     del: async (key) => { /* ... */ },
   };
   ```

3. ‚úÖ –°–æ–∑–¥–∞—Ç—å `lib/cache/memory.ts` (fallback)

**–î–µ–Ω—å 2:**
4. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ API routes:
   ```typescript
   export async function GET(request) {
     const cacheKey = `tours:${searchParams}`;
     
     // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫—ç—à
     const cached = await cache.get(cacheKey);
     if (cached) return NextResponse.json(cached);
     
     // –ó–∞–ø—Ä–æ—Å –∫ –ë–î
     const data = await query(...);
     
     // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –∫—ç—à
     await cache.set(cacheKey, data, 300);
     
     return NextResponse.json(data);
   }
   ```

5. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å invalidation:
   - –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏/–æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —Ç—É—Ä–∞ ‚Üí –∏–Ω–≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å –∫—ç—à
   - –ü—Ä–∏ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–∏ ‚Üí –∏–Ω–≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å —Å–≤—è–∑–∞–Ω–Ω—ã–µ –∫–ª—é—á–∏

6. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å cache headers –¥–ª—è –∫–ª–∏–µ–Ω—Ç–∞:
   ```typescript
   response.headers.set('Cache-Control', 'public, s-maxage=300');
   ```

**–û—Ü–µ–Ω–∫–∞ –≤—Ä–µ–º–µ–Ω–∏:** 12-16 —á–∞—Å–æ–≤  
**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** –°—Ä–µ–¥–Ω—è—è-–í—ã—Å–æ–∫–∞—è  
**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** –ù–µ—Ç (–º–æ–∂–Ω–æ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ)

---

#### 3.3 –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–∞–≥–∏–Ω–∞—Ü–∏–∏ (1 –¥–µ–Ω—å)

**–ó–∞–¥–∞—á–∞:** –ü–∞–≥–∏–Ω–∞—Ü–∏—è –¥–ª—è –≤—Å–µ—Ö —Å–ø–∏—Å–∫–æ–≤

**Endpoints –¥–ª—è –ø–∞–≥–∏–Ω–∞—Ü–∏–∏:**
```
/api/tours?page=1&limit=20
/api/transfers/search?page=1&limit=10
/api/operator/bookings?page=1&limit=50
/api/partners?page=1&limit=20
```

**–®–∞–≥–∏:**
1. ‚úÖ –°–æ–∑–¥–∞—Ç—å `lib/utils/pagination.ts`:
   ```typescript
   export function paginate<T>(
     items: T[],
     page: number,
     limit: number
   ): PaginatedResult<T> {
     const offset = (page - 1) * limit;
     return {
       data: items.slice(offset, offset + limit),
       pagination: {
         page,
         limit,
         total: items.length,
         totalPages: Math.ceil(items.length / limit),
       },
     };
   }
   ```

2. ‚úÖ –û–±–Ω–æ–≤–∏—Ç—å API routes (10+ —Ñ–∞–π–ª–æ–≤):
   - –î–æ–±–∞–≤–∏—Ç—å page, limit –≤ query params
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å LIMIT/OFFSET –≤ SQL
   - –í–æ–∑–≤—Ä–∞—â–∞—Ç—å pagination metadata

3. ‚úÖ –û–±–Ω–æ–≤–∏—Ç—å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥:
   - –î–æ–±–∞–≤–∏—Ç—å Pagination –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
   - –û–±–Ω–æ–≤–∏—Ç—å —Å–ø–∏—Å–∫–∏ –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø–∞–≥–∏–Ω–∞—Ü–∏–∏

**–û—Ü–µ–Ω–∫–∞ –≤—Ä–µ–º–µ–Ω–∏:** 6-8 —á–∞—Å–æ–≤  
**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** –ù–∏–∑–∫–∞—è-–°—Ä–µ–¥–Ω—è—è  
**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** –ù–µ—Ç

---

### üìä –ò—Ç–æ–≥–∏ –§–∞–∑—ã 3:
- **–í—Ä–µ–º—è:** 4-5 –¥–Ω–µ–π
- **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ë—ã—Å—Ç—Ä—ã–µ –∑–∞–ø—Ä–æ—Å—ã, –º–µ–Ω—å—à–µ –Ω–∞–≥—Ä—É–∑–∫–∏
- **–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É:** 85% ‚Üí 90%

---

## üèóÔ∏è –§–ê–ó–ê 4: –ê–†–•–ò–¢–ï–ö–¢–£–†–ê (–ù–µ–¥–µ–ª—è 4-5)

### üü¢ –ñ–ï–õ–ê–¢–ï–õ–¨–ù–û - –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3

#### 4.1 –°–æ–∑–¥–∞–Ω–∏–µ Service Layer (2 –¥–Ω—è)

**–ó–∞–¥–∞—á–∞:** –í—ã–Ω–µ—Å—Ç–∏ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É –∏–∑ API routes

**–ù–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:**
```
lib/services/
‚îú‚îÄ‚îÄ tour-service.ts
‚îú‚îÄ‚îÄ transfer-service.ts
‚îú‚îÄ‚îÄ booking-service.ts
‚îú‚îÄ‚îÄ payment-service.ts
‚îî‚îÄ‚îÄ loyalty-service.ts
```

**–®–∞–≥–∏:**

**–î–µ–Ω—å 1:**
1. ‚úÖ –°–æ–∑–¥–∞—Ç—å `lib/services/tour-service.ts`:
   ```typescript
   export class TourService {
     async findTours(filters: TourFilters): Promise<Tour[]>
     async findById(id: string): Promise<Tour>
     async create(data: CreateTourData): Promise<Tour>
     async update(id: string, data: UpdateTourData): Promise<Tour>
     async delete(id: string): Promise<void>
   }
   ```

2. ‚úÖ –°–æ–∑–¥–∞—Ç—å `lib/services/transfer-service.ts`:
   - `searchTransfers()`
   - `bookTransfer()`
   - `confirmTransfer()`

3. ‚úÖ –°–æ–∑–¥–∞—Ç—å –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã

**–î–µ–Ω—å 2:**
4. ‚úÖ –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏—Ç—å API routes:
   ```typescript
   // –ë—ã–ª–æ:
   const result = await query('SELECT * FROM tours WHERE ...');
   
   // –°—Ç–∞–ª–æ:
   const tours = await tourService.findTours(filters);
   ```

5. ‚úÖ –û–±–Ω–æ–≤–∏—Ç—å –≤—Å–µ API routes (15+ —Ñ–∞–π–ª–æ–≤)

**–û—Ü–µ–Ω–∫–∞ –≤—Ä–µ–º–µ–Ω–∏:** 16-20 —á–∞—Å–æ–≤  
**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** –í—ã—Å–æ–∫–∞—è  
**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** –ú–æ–∂–Ω–æ –¥–µ–ª–∞—Ç—å –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ

---

#### 4.2 Repository Pattern (2 –¥–Ω—è)

**–ó–∞–¥–∞—á–∞:** –ê–±—Å—Ç—Ä–∞–∫—Ü–∏—è –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∞–Ω–Ω—ã–º

**–°–æ–∑–¥–∞—Ç—å:**
```
lib/repositories/
‚îú‚îÄ‚îÄ tour-repository.ts
‚îú‚îÄ‚îÄ transfer-repository.ts
‚îú‚îÄ‚îÄ booking-repository.ts
‚îî‚îÄ‚îÄ user-repository.ts
```

**–®–∞–≥–∏:**
1. ‚úÖ –°–æ–∑–¥–∞—Ç—å –±–∞–∑–æ–≤—ã–π Repository –∫–ª–∞—Å—Å
2. ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏
3. ‚úÖ –û–±–Ω–æ–≤–∏—Ç—å —Å–µ—Ä–≤–∏—Å—ã –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤
4. ‚úÖ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å

**–û—Ü–µ–Ω–∫–∞ –≤—Ä–µ–º–µ–Ω–∏:** 16-20 —á–∞—Å–æ–≤  
**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** –í—ã—Å–æ–∫–∞—è  
**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** –ó–∞–≤–∏—Å–∏—Ç –æ—Ç 4.1

---

### üìä –ò—Ç–æ–≥–∏ –§–∞–∑—ã 4:
- **–í—Ä–µ–º—è:** 4-5 –¥–Ω–µ–π
- **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ß–∏—Å—Ç–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞, –ª–µ–≥—á–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å
- **–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É:** 90% ‚Üí 93%

---

## üß™ –§–ê–ó–ê 5: –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï (–ù–µ–¥–µ–ª—è 5-6)

### üü° –í–ê–ñ–ù–û - –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2

#### 5.1 Unit —Ç–µ—Å—Ç—ã –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –º–æ–¥—É–ª–µ–π (3 –¥–Ω—è)

**–ó–∞–¥–∞—á–∞:** –ü–æ–∫—Ä—ã—Ç—å —Ç–µ—Å—Ç–∞–º–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫—É—é –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:**
```
–ö—Ä–∏—Ç–∏—á–Ω–æ:
‚îú‚îÄ‚îÄ lib/transfers/booking.ts        ‚Üí Race conditions
‚îú‚îÄ‚îÄ lib/payments/transfer-payments.ts ‚Üí –ü–ª–∞—Ç–µ–∂–∏
‚îú‚îÄ‚îÄ lib/auth/jwt.ts                 ‚Üí –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
‚îî‚îÄ‚îÄ lib/loyalty/loyalty-system.ts   ‚Üí –õ–æ—è–ª—å–Ω–æ—Å—Ç—å

–í–∞–∂–Ω–æ:
‚îú‚îÄ‚îÄ lib/transfers/matching.ts       ‚Üí –ê–ª–≥–æ—Ä–∏—Ç–º —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è
‚îî‚îÄ‚îÄ lib/middleware/csrf.ts          ‚Üí CSRF –∑–∞—â–∏—Ç–∞
```

**–®–∞–≥–∏:**

**–î–µ–Ω—å 1:**
1. ‚úÖ –¢–µ—Å—Ç—ã –¥–ª—è `booking.ts`:
   - –¢–µ—Å—Ç race condition –∑–∞—â–∏—Ç—ã
   - –¢–µ—Å—Ç –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã—Ö –º–µ—Å—Ç
   - –¢–µ—Å—Ç –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫

2. ‚úÖ –¢–µ—Å—Ç—ã –¥–ª—è `jwt.ts`:
   - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–æ–∫–µ–Ω–∞
   - –í–∞–ª–∏–¥–∞—Ü–∏—è —Ç–æ–∫–µ–Ω–∞
   - –ò—Å—Ç–µ—á–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞

**–î–µ–Ω—å 2:**
3. ‚úÖ –¢–µ—Å—Ç—ã –¥–ª—è `transfer-payments.ts`:
   - –°–æ–∑–¥–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞
   - –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞
   - –í–æ–∑–≤—Ä–∞—Ç —Å—Ä–µ–¥—Å—Ç–≤

4. ‚úÖ –¢–µ—Å—Ç—ã –¥–ª—è `loyalty-system.ts`:
   - –ù–∞—á–∏—Å–ª–µ–Ω–∏–µ –±–∞–ª–ª–æ–≤
   - –ü–æ–≤—ã—à–µ–Ω–∏–µ —É—Ä–æ–≤–Ω—è
   - –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤

**–î–µ–Ω—å 3:**
5. ‚úÖ –¢–µ—Å—Ç—ã –¥–ª—è `matching.ts`:
   - –ê–ª–≥–æ—Ä–∏—Ç–º —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è
   - –í–µ—Å–∞ –∫—Ä–∏—Ç–µ—Ä–∏–µ–≤
   - –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

6. ‚úÖ –û–±–Ω–æ–≤–∏—Ç—å coverage –¥–æ 80%+

**–û—Ü–µ–Ω–∫–∞ –≤—Ä–µ–º–µ–Ω–∏:** 20-24 —á–∞—Å–∞  
**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** –°—Ä–µ–¥–Ω—è—è  
**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** –ù–µ—Ç

---

#### 5.2 Integration —Ç–µ—Å—Ç—ã –¥–ª—è API (2 –¥–Ω—è)

**–ó–∞–¥–∞—á–∞:** –¢–µ—Å—Ç—ã –¥–ª—è API endpoints

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã–µ endpoints:**
```
/api/transfers/book       ‚Üí –ö—Ä–∏—Ç–∏—á–Ω–æ
/api/transfers/search     ‚Üí –í–∞–∂–Ω–æ
/api/tours (POST)         ‚Üí –í–∞–∂–Ω–æ
/api/auth/signin          ‚Üí –í–∞–∂–Ω–æ
/api/payments/confirm     ‚Üí –ö—Ä–∏—Ç–∏—á–Ω–æ
```

**–®–∞–≥–∏:**
1. ‚úÖ –ù–∞—Å—Ç—Ä–æ–∏—Ç—å test database
2. ‚úÖ –°–æ–∑–¥–∞—Ç—å fixtures –¥–ª—è —Ç–µ—Å—Ç–æ–≤
3. ‚úÖ –ù–∞–ø–∏—Å–∞—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ endpoint
4. ‚úÖ –¢–µ—Å—Ç—ã –¥–ª—è edge cases

**–û—Ü–µ–Ω–∫–∞ –≤—Ä–µ–º–µ–Ω–∏:** 12-16 —á–∞—Å–æ–≤  
**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** –°—Ä–µ–¥–Ω—è—è  
**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** –ù–µ—Ç

---

### üìä –ò—Ç–æ–≥–∏ –§–∞–∑—ã 5:
- **–í—Ä–µ–º—è:** 5-6 –¥–Ω–µ–π
- **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ü–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏ 80%+
- **–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É:** 93% ‚Üí 95%

---

## ‚ú® –§–ê–ó–ê 6: –ü–û–õ–ò–†–û–í–ö–ê (–ù–µ–¥–µ–ª—è 6-7)

### üü¢ –ñ–ï–õ–ê–¢–ï–õ–¨–ù–û - –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3

#### 6.1 Command Palette (‚åòK) (1 –¥–µ–Ω—å)

**–ó–∞–¥–∞—á–∞:** –ë—ã—Å—Ç—Ä—ã–π –¥–æ—Å—Ç—É–ø –∫ —Ñ—É–Ω–∫—Ü–∏—è–º —á–µ—Ä–µ–∑ ‚åòK

**–®–∞–≥–∏:**
1. ‚úÖ –°–æ–∑–¥–∞—Ç—å `components/CommandPalette/CommandPalette.tsx`
2. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å keyboard listener (‚åòK)
3. ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø–æ–∏—Å–∫ –∫–æ–º–∞–Ω–¥
4. ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Å –Ω–∞–≤–∏–≥–∞—Ü–∏–µ–π

**–û—Ü–µ–Ω–∫–∞ –≤—Ä–µ–º–µ–Ω–∏:** 6-8 —á–∞—Å–æ–≤  
**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** –°—Ä–µ–¥–Ω—è—è  
**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** –ó–∞–≤–∏—Å–∏—Ç –æ—Ç 2.1 (–Ω—É–∂–Ω–∞ –Ω–∞–≤–∏–≥–∞—Ü–∏—è)

---

#### 6.2 –ê–Ω–∏–º–∞—Ü–∏–∏ –∏ transitions (1 –¥–µ–Ω—å)

**–ó–∞–¥–∞—á–∞:** –ü–ª–∞–≤–Ω—ã–µ –ø–µ—Ä–µ—Ö–æ–¥—ã –∏ –º–∏–∫—Ä–æ–∞–Ω–∏–º–∞—Ü–∏–∏

**–®–∞–≥–∏:**
1. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å transitions –º–µ–∂–¥—É —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º–∏
2. ‚úÖ –ê–Ω–∏–º–∞—Ü–∏–∏ –¥–ª—è –∫–∞—Ä—Ç–æ—á–µ–∫ (hover, appear)
3. ‚úÖ Loading states —Å skeleton screens
4. ‚úÖ Toast notifications —Å –∞–Ω–∏–º–∞—Ü–∏—è–º–∏

**–û—Ü–µ–Ω–∫–∞ –≤—Ä–µ–º–µ–Ω–∏:** 6-8 —á–∞—Å–æ–≤  
**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** –ù–∏–∑–∫–∞—è  
**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** –ù–µ—Ç

---

#### 6.3 –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö (1 –¥–µ–Ω—å)

**–ó–∞–¥–∞—á–∞:** –£–ª—É—á—à–∏—Ç—å –º–æ–±–∏–ª—å–Ω—ã–π –æ–ø—ã—Ç

**–®–∞–≥–∏:**
1. ‚úÖ –£–ª—É—á—à–∏—Ç—å touch targets (–º–∏–Ω–∏–º—É–º 44x44px)
2. ‚úÖ –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ñ–æ—Ä–º—ã –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö
3. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å pull-to-refresh
4. ‚úÖ –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è

**–û—Ü–µ–Ω–∫–∞ –≤—Ä–µ–º–µ–Ω–∏:** 6-8 —á–∞—Å–æ–≤  
**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** –ù–∏–∑–∫–∞—è  
**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** –ó–∞–≤–∏—Å–∏—Ç –æ—Ç 2.1

---

### üìä –ò—Ç–æ–≥–∏ –§–∞–∑—ã 6:
- **–í—Ä–µ–º—è:** 3 –¥–Ω—è
- **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ü–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
- **–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É:** 95% ‚Üí 98%

---

## üìä –û–ë–©–ê–Ø –°–¢–ê–¢–ò–°–¢–ò–ö–ê –ü–õ–ê–ù–ê

### –í—Ä–µ–º–µ–Ω–Ω—ã–µ –∑–∞—Ç—Ä–∞—Ç—ã:

| –§–∞–∑–∞ | –í—Ä–µ–º—è | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç |
|------|-------|-----------|
| –§–∞–∑–∞ 1: –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å | 4-5 –¥–Ω–µ–π | üî¥ –ö—Ä–∏—Ç–∏—á–Ω–æ |
| –§–∞–∑–∞ 2: –î–∏–∑–∞–π–Ω | 4-5 –¥–Ω–µ–π | üü° –í–∞–∂–Ω–æ |
| –§–∞–∑–∞ 3: –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å | 4-5 –¥–Ω–µ–π | üü° –í–∞–∂–Ω–æ |
| –§–∞–∑–∞ 4: –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ | 4-5 –¥–Ω–µ–π | üü¢ –ñ–µ–ª–∞—Ç–µ–ª—å–Ω–æ |
| –§–∞–∑–∞ 5: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ | 5-6 –¥–Ω–µ–π | üü° –í–∞–∂–Ω–æ |
| –§–∞–∑–∞ 6: –ü–æ–ª–∏—Ä–æ–≤–∫–∞ | 3 –¥–Ω—è | üü¢ –ñ–µ–ª–∞—Ç–µ–ª—å–Ω–æ |
| **–ò–¢–û–ì–û** | **24-29 –¥–Ω–µ–π** | **6-8 –Ω–µ–¥–µ–ª—å** |

### –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω (—Ç–æ–ª—å–∫–æ –∫—Ä–∏—Ç–∏—á–Ω–æ–µ):
- **–§–∞–∑–∞ 1:** 4-5 –¥–Ω–µ–π
- **–§–∞–∑–∞ 2:** 4-5 –¥–Ω–µ–π
- **–ò—Ç–æ–≥–æ:** 8-10 –¥–Ω–µ–π (2 –Ω–µ–¥–µ–ª–∏)

### –û–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω (–∫—Ä–∏—Ç–∏—á–Ω–æ–µ + –≤–∞–∂–Ω–æ):
- **–§–∞–∑–∞ 1-3:** 12-15 –¥–Ω–µ–π
- **–§–∞–∑–∞ 5:** 5-6 –¥–Ω–µ–π
- **–ò—Ç–æ–≥–æ:** 17-21 –¥–µ–Ω—å (3-4 –Ω–µ–¥–µ–ª–∏)

---

## üéØ –ü–†–ò–û–†–ò–¢–ï–¢–´ –ü–û –ó–ê–î–ê–ß–ê–ú

### üî¥ –î–µ–ª–∞—Ç—å –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ (–ù–µ–¥–µ–ª—è 1):
1. CSRF –∑–∞—â–∏—Ç–∞
2. Rate Limiting
3. JWT –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
4. –£–±—Ä–∞—Ç—å console.log

### üü° –°–¥–µ–ª–∞—Ç—å –≤ –ø–µ—Ä–≤—É—é –æ—á–µ—Ä–µ–¥—å (–ù–µ–¥–µ–ª—è 2-3):
5. Sidebar Navigation
6. –£–ø—Ä–æ—â–µ–Ω–∏–µ –≥–ª–∞–≤–Ω–æ–π
7. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ N+1 –∑–∞–ø—Ä–æ—Å–æ–≤
8. –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ

### üü¢ –ú–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –ø–æ–∑–∂–µ (–ù–µ–¥–µ–ª—è 4+):
9. Service Layer
10. Repository Pattern
11. Command Palette
12. –ê–Ω–∏–º–∞—Ü–∏–∏

---

## ‚úÖ –ß–ï–ö–õ–ò–°–¢ –ì–û–¢–û–í–ù–û–°–¢–ò –ö –ü–†–û–î–ê–ö–®–ï–ù–£

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:
- [ ] CSRF –∑–∞—â–∏—Ç–∞ –≤–µ–∑–¥–µ
- [ ] Rate Limiting –Ω–∞ –≤—Å–µ—Ö endpoints
- [ ] JWT –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
- [ ] Security headers
- [ ] Input validation

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:
- [ ] –ù–µ—Ç N+1 –∑–∞–ø—Ä–æ—Å–æ–≤
- [ ] –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ
- [ ] –ü–∞–≥–∏–Ω–∞—Ü–∏—è –≤–µ–∑–¥–µ
- [ ] –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ SQL –∑–∞–ø—Ä–æ—Å—ã

### UX/UI:
- [ ] –£–¥–æ–±–Ω–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è
- [ ] –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –¥–∏–∑–∞–π–Ω
- [ ] Loading states
- [ ] Error handling

### –ö–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞:
- [ ] –ù–µ—Ç console.log
- [ ] –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ
- [ ] –¢–µ—Å—Ç—ã –Ω–∞–ø–∏—Å–∞–Ω—ã (80%+)
- [ ] –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞

---

## üöÄ –ù–ê–ß–ê–õ–û –†–ê–ë–û–¢–´

### –ü–µ—Ä–≤—ã–µ —à–∞–≥–∏ (—Å–µ–≥–æ–¥–Ω—è):

1. **–ù–∞—á–∞—Ç—å —Å –§–∞–∑—ã 1.1** - CSRF –∑–∞—â–∏—Ç–∞
   - –°–æ–∑–¥–∞—Ç—å wrapper –¥–ª—è –∫–ª–∏–µ–Ω—Ç–∞
   - –û–±–Ω–æ–≤–∏—Ç—å 3-4 –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö route
   - –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å

2. **–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ** - –§–∞–∑–∞ 1.4
   - –°–æ–∑–¥–∞—Ç—å logger
   - –ó–∞–º–µ–Ω–∏—Ç—å console.log –≤ 5 —Ñ–∞–π–ª–∞—Ö

### –ó–∞–≤—Ç—Ä–∞:
3. **–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –§–∞–∑—É 1.1** - –û—Å—Ç–∞–ª—å–Ω—ã–µ routes
4. **–ù–∞—á–∞—Ç—å –§–∞–∑—É 1.2** - Rate Limiting

---

## üìù –ó–ê–ú–ï–¢–ö–ò

- –í—Å–µ —Ñ–∞–∑—ã –º–æ–∂–Ω–æ –¥–µ–ª–∞—Ç—å –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ (–∫—Ä–æ–º–µ –∑–∞–≤–∏—Å–∏–º—ã—Ö –∑–∞–¥–∞—á)
- –ú–æ–∂–Ω–æ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –§–∞–∑—É 4 (–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞) –µ—Å–ª–∏ –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ
- –§–∞–∑–∞ 5 (–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ) –≤–∞–∂–Ω–∞ –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏
- –§–∞–∑–∞ 6 (–ü–æ–ª–∏—Ä–æ–≤–∫–∞) –º–æ–∂–Ω–æ –¥–µ–ª–∞—Ç—å –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ

---

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** –î–µ–∫–∞–±—Ä—å 2024  
**–í–µ—Ä—Å–∏—è:** 1.0  
**–°—Ç–∞—Ç—É—Å:** –ì–æ—Ç–æ–≤ –∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—é
