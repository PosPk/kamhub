# üîß –ê–î–ê–ü–¢–ê–¶–ò–Ø –ü–û–î TIMEWEB CLOUD

**–î–∞—Ç–∞:** 30.10.2025  
**–ë—ã–ª–æ:** Vercel + Yandex Cloud  
**–°—Ç–∞–ª–æ:** Timeweb Cloud (Node.js VDS)

---

## ‚úÖ –ß–¢–û –ò–ó–ú–ï–ù–ï–ù–û

### 1. **Edge Runtime ‚Üí Node.js Runtime**

**–§–∞–π–ª:** `app/api/ai/route.ts`

**–ë—ã–ª–æ (Vercel):**
```typescript
export const runtime = 'edge'  // ‚ùå –¢–æ–ª—å–∫–æ Vercel!
```

**–°—Ç–∞–ª–æ (Timeweb):**
```typescript
export const runtime = 'nodejs'  // ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ Node.js VDS
```

**–ü–æ—á–µ–º—É:** Edge runtime –µ—Å—Ç—å —Ç–æ–ª—å–∫–æ –Ω–∞ Vercel. –ù–∞ –æ–±—ã—á–Ω–æ–º Node.js —Å–µ—Ä–≤–µ—Ä–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π runtime.

---

### 2. **–î–æ–±–∞–≤–ª–µ–Ω PM2 –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è**

**–§–∞–π–ª:** `ecosystem.config.js` (–Ω–æ–≤—ã–π)

**–î–ª—è —á–µ–≥–æ:** –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–æ–º Next.js –Ω–∞ VDS

```javascript
module.exports = {
  apps: [{
    name: 'kamchatour-hub',
    script: 'npm',
    args: 'start',
    instances: 2,        // 2 –ø—Ä–æ—Ü–µ—Å—Å–∞ (cluster mode)
    exec_mode: 'cluster',
    autorestart: true,
    max_memory_restart: '1G',
    env: {
      NODE_ENV: 'production',
      PORT: 3000
    }
  }]
};
```

**–ó–∞–º–µ–Ω–∞ –¥–ª—è:** Vercel –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–ø—Ä–∞–≤–ª—è–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏

---

### 3. **–î–æ–±–∞–≤–ª–µ–Ω .env.example**

**–§–∞–π–ª:** `.env.example` (–Ω–æ–≤—ã–π)

**–î–ª—è —á–µ–≥–æ:** –®–∞–±–ª–æ–Ω –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è Timeweb Cloud

**–û—Ç–ª–∏—á–∏—è –æ—Ç Vercel:**
- –ù–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö Vercel (VERCEL_URL, etc.)
- –Ø–≤–Ω–æ —É–∫–∞–∑–∞–Ω—ã –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
- –î–æ–±–∞–≤–ª–µ–Ω—ã –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è Timeweb —Ä–µ—Å—É—Ä—Å–æ–≤

---

### 4. **–ü–æ–º–µ—á–µ–Ω vercel.json**

**–§–∞–π–ª:** `vercel.json` (–æ–±–Ω–æ–≤–ª—ë–Ω)

–î–æ–±–∞–≤–ª–µ–Ω –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π:
```json
{
  "_comment": "–≠—Ç–æ—Ç —Ñ–∞–π–ª –¥–ª—è Vercel, –Ω–æ –ø—Ä–æ–µ–∫—Ç —Ç–µ–ø–µ—Ä—å –Ω–∞ Timeweb Cloud",
  "_note": "–î–ª—è Timeweb –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è ecosystem.config.js (PM2)"
}
```

**–ú–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å?** –î–∞, –Ω–æ –æ—Å—Ç–∞–≤–∏–ª –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ (–µ—Å–ª–∏ –∑–∞—Ö–æ—Ç–∏—Ç–µ –≤–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ Vercel)

---

## üìä –°–†–ê–í–ù–ï–ù–ò–ï: VERCEL vs TIMEWEB

| –ê—Å–ø–µ–∫—Ç | Vercel | Timeweb Cloud |
|--------|--------|---------------|
| **–î–µ–ø–ª–æ–π** | git push ‚Üí –∞–≤—Ç–æ | git push ‚Üí GitHub Actions ‚Üí rsync |
| **Runtime** | Edge + Node.js | Node.js —Ç–æ–ª—å–∫–æ |
| **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö** | Vercel Postgres | Timeweb PostgreSQL |
| **–•—Ä–∞–Ω–∏–ª–∏—â–µ** | Vercel Blob | Timeweb S3 |
| **–ü—Ä–æ—Ü–µ—Å—Å –º–µ–Ω–µ–¥–∂–µ—Ä** | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π | PM2 (–≤—Ä—É—á–Ω—É—é) |
| **SSL** | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π | Certbot (–≤—Ä—É—á–Ω—É—é) |
| **–ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ** | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ | –í—Ä—É—á–Ω—É—é (—É–≤–µ–ª–∏—á–∏—Ç—å VDS) |
| **–°—Ç–æ–∏–º–æ—Å—Ç—å** | $0-20/–º–µ—Å | ~581‚ÇΩ/–º–µ—Å (~$6) |

---

## üîß –ß–¢–û –ù–£–ñ–ù–û –ù–ê–°–¢–†–û–ò–¢–¨ –í–†–£–ß–ù–£–Æ

### –ù–∞ Timeweb Cloud (–≤ –æ—Ç–ª–∏—á–∏–µ –æ—Ç Vercel):

1. **Nginx** - reverse proxy
   - Vercel: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
   - Timeweb: –≤—Ä—É—á–Ω—É—é —á–µ—Ä–µ–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é

2. **SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç**
   - Vercel: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
   - Timeweb: Certbot –≤—Ä—É—á–Ω—É—é

3. **PM2** - –ø—Ä–æ—Ü–µ—Å—Å –º–µ–Ω–µ–¥–∂–µ—Ä
   - Vercel: –Ω–µ –Ω—É–∂–µ–Ω
   - Timeweb: –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ

4. **Firewall**
   - Vercel: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
   - Timeweb: UFW –≤—Ä—É—á–Ω—É—é

5. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**
   - Vercel: –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π
   - Timeweb: Sentry/PM2 logs

---

## ‚úÖ –ß–¢–û –†–ê–ë–û–¢–ê–ï–¢ –ë–ï–ó –ò–ó–ú–ï–ù–ï–ù–ò–ô

### –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:
- ‚úÖ Next.js 14
- ‚úÖ React 18
- ‚úÖ TypeScript
- ‚úÖ TailwindCSS
- ‚úÖ API Routes

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏:
- ‚úÖ AI –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã (GROQ, DeepSeek, OpenRouter)
- ‚úÖ Yandex Maps API
- ‚úÖ Yandex Weather API
- ‚úÖ PostgreSQL
- ‚úÖ –ü–ª–∞—Ç—ë–∂–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã

**lib/config.ts —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π!** –†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –ª—é–±–æ–π –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ!

---

## üöÄ –û–ë–ù–û–í–õ–Å–ù–ù–´–ô –°–ö–†–ò–ü–¢ –î–ï–ü–õ–û–Ø

**–§–∞–π–ª:** `auto-deploy-kamchatour.sh` (–æ–±–Ω–æ–≤–ª—ë–Ω)

**–¢–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç:**
- ‚úÖ `ecosystem.config.js` –≤–º–µ—Å—Ç–æ –ø—Ä–æ—Å—Ç–æ–≥–æ `npm start`
- ‚úÖ Cluster mode (2 –ø—Ä–æ—Ü–µ—Å—Å–∞)
- ‚úÖ –õ–æ–≥–∏ –≤ `./logs/`
- ‚úÖ Auto-restart –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏

---

## üìã –ú–ò–ì–†–ê–¶–ò–Ø –° VERCEL –ù–ê TIMEWEB

### –ï—Å–ª–∏ —É –≤–∞—Å —É–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ Vercel:

**1. –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ Vercel Postgres:**
```bash
# –õ–æ–∫–∞–ª—å–Ω–æ
pg_dump $VERCEL_DATABASE_URL > backup.sql
```

**2. –ò–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –≤ Timeweb PostgreSQL:**
```bash
psql $TIMEWEB_DATABASE_URL < backup.sql
```

**3. –û–±–Ω–æ–≤–∏—Ç–µ DNS:**
```
A    kamchatour.ru    45.8.96.120
```

**4. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ SSL –Ω–∞ Timeweb:**
```bash
certbot --nginx -d kamchatour.ru
```

---

## üîç –ß–¢–û –ï–©–Å –ü–†–û–í–ï–†–ò–¢–¨

–ò—â—É –¥—Ä—É–≥–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã:

<function_calls>
<invoke name="Grep">
<parameter name="pattern">process\.env\.VERCEL